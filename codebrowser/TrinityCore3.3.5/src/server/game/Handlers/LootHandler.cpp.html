<!doctype html>
<html>
<head>
<title>LootHandler.cpp [TrinityCore3.3.5/src/server/game/Handlers/LootHandler.cpp] - Woboq Code Browser</title>
<link rel="stylesheet" href="../../../../../../data/kdevelop.css" title="KDevelop"/>
<link rel="alternate stylesheet" href="../../../../../../data/qtcreator.css" title="QtCreator"/>
<script type="text/javascript" src="../../../../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'TrinityCore3.3.5/src/server/game/Handlers/LootHandler.cpp'; var root_path = '../../../../..'; var data_path = '../../../../../../data';</script>
<script src='../../../../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Source code of </span><a href='../../../..'>TrinityCore3.3.5</a>/<a href='../../..'>src</a>/<a href='../..'>server</a>/<a href='..'>game</a>/<a href='./'>Handlers</a>/LootHandler.cpp</h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> * Copyright (C) 2008-2016 TrinityCore &lt;<a href="http://www.trinitycore.org/">http://www.trinitycore.org/</a>&gt;</i></td></tr>
<tr><th id="3">3</th><td><i> * Copyright (C) 2005-2009 MaNGOS &lt;<a href="http://getmangos.com/">http://getmangos.com/</a>&gt;</i></td></tr>
<tr><th id="4">4</th><td><i> *</i></td></tr>
<tr><th id="5">5</th><td><i> * This program is free software; you can redistribute it and/or modify it</i></td></tr>
<tr><th id="6">6</th><td><i> * under the terms of the GNU General Public License as published by the</i></td></tr>
<tr><th id="7">7</th><td><i> * Free Software Foundation; either version 2 of the License, or (at your</i></td></tr>
<tr><th id="8">8</th><td><i> * option) any later version.</i></td></tr>
<tr><th id="9">9</th><td><i> *</i></td></tr>
<tr><th id="10">10</th><td><i> * This program is distributed in the hope that it will be useful, but WITHOUT</i></td></tr>
<tr><th id="11">11</th><td><i> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</i></td></tr>
<tr><th id="12">12</th><td><i> * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for</i></td></tr>
<tr><th id="13">13</th><td><i> * more details.</i></td></tr>
<tr><th id="14">14</th><td><i> *</i></td></tr>
<tr><th id="15">15</th><td><i> * You should have received a copy of the GNU General Public License along</i></td></tr>
<tr><th id="16">16</th><td><i> * with this program. If not, see &lt;<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.</i></td></tr>
<tr><th id="17">17</th><td><i> */</i></td></tr>
<tr><th id="18">18</th><td></td></tr>
<tr><th id="19">19</th><td><u>#include <a href="../../../common/Common.h.html">"Common.h"</a></u></td></tr>
<tr><th id="20">20</th><td><u>#include <a href="../../../common/Logging/Log.h.html">"Log.h"</a></u></td></tr>
<tr><th id="21">21</th><td><u>#include <a href="../Entities/Corpse/Corpse.h.html">"Corpse.h"</a></u></td></tr>
<tr><th id="22">22</th><td><u>#include <a href="../Entities/Creature/Creature.h.html">"Creature.h"</a></u></td></tr>
<tr><th id="23">23</th><td><u>#include <a href="../Entities/GameObject/GameObject.h.html">"GameObject.h"</a></u></td></tr>
<tr><th id="24">24</th><td><u>#include <a href="../Groups/Group.h.html">"Group.h"</a></u></td></tr>
<tr><th id="25">25</th><td><u>#include <a href="../Loot/LootMgr.h.html">"LootMgr.h"</a></u></td></tr>
<tr><th id="26">26</th><td><u>#include <a href="../Globals/ObjectAccessor.h.html">"ObjectAccessor.h"</a></u></td></tr>
<tr><th id="27">27</th><td><u>#include <a href="../Entities/Object/Object.h.html">"Object.h"</a></u></td></tr>
<tr><th id="28">28</th><td><u>#include <a href="../Entities/Player/Player.h.html">"Player.h"</a></u></td></tr>
<tr><th id="29">29</th><td><u>#include <a href="../../shared/Packets/WorldPacket.h.html">"WorldPacket.h"</a></u></td></tr>
<tr><th id="30">30</th><td><u>#include <a href="../Server/WorldSession.h.html">"WorldSession.h"</a></u></td></tr>
<tr><th id="31">31</th><td></td></tr>
<tr><th id="32">32</th><td><em>void</em> <a class="type" href="../Server/WorldSession.h.html#WorldSession" title='WorldSession' data-ref="WorldSession" >WorldSession</a>::<dfn class="decl def" id="_ZN12WorldSession29HandleAutostoreLootItemOpcodeER11WorldPacket" title='WorldSession::HandleAutostoreLootItemOpcode' data-ref="_ZN12WorldSession29HandleAutostoreLootItemOpcodeER11WorldPacket" >HandleAutostoreLootItemOpcode</dfn>(<a class="type" href="../../shared/Packets/WorldPacket.h.html#WorldPacket" title='WorldPacket' data-ref="WorldPacket" >WorldPacket</a>&amp; <dfn class="local col1 decl" id="1recvData" title='recvData' data-type='WorldPacket &amp;' data-ref="1recvData" >recvData</dfn>)</td></tr>
<tr><th id="33">33</th><td>{</td></tr>
<tr><th id="34">34</th><td>    <a class="macro" href="../../../common/Logging/Log.h.html#201" title="do { if (Log::instance()-&gt;ShouldLog(&quot;network&quot;, LOG_LEVEL_DEBUG)) { if (false) check_args(&quot;WORLD: CMSG_AUTOSTORE_LOOT_ITEM&quot;); { try { Log::instance()-&gt;outMessage(&quot;network&quot;, LOG_LEVEL_DEBUG, &quot;WORLD: CMSG_AUTOSTORE_LOOT_ITEM&quot;); } catch (std::exception&amp; e) { Log::instance()-&gt;outMessage(&quot;server&quot;, LOG_LEVEL_ERROR, &quot;Wrong format occurred (%s) at %s:%u.&quot;, e.what(), &quot;/home/nayd/TrinityCore/src/server/game/Handlers/LootHandler.cpp&quot;, 34); } }; } } while (0)" data-ref="_M/TC_LOG_DEBUG">TC_LOG_DEBUG</a>(<q>"network"</q>, <q>"WORLD: CMSG_AUTOSTORE_LOOT_ITEM"</q>);</td></tr>
<tr><th id="35">35</th><td>    <a class="type" href="../Entities/Player/Player.h.html#Player" title='Player' data-ref="Player" >Player</a>* <dfn class="local col2 decl" id="2player" title='player' data-type='Player *' data-ref="2player" >player</dfn> = <a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>();</td></tr>
<tr><th id="36">36</th><td>    <a class="type" href="../Entities/Object/ObjectGuid.h.html#ObjectGuid" title='ObjectGuid' data-ref="ObjectGuid" >ObjectGuid</a> <dfn class="local col3 decl" id="3lguid" title='lguid' data-type='ObjectGuid' data-ref="3lguid" >lguid</dfn> = <a class="local col2 ref" href="#2player" title='player' data-ref="2player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZNK6Player11GetLootGUIDEv" title='Player::GetLootGUID' data-ref="_ZNK6Player11GetLootGUIDEv" id="_ZNK6Player11GetLootGUIDEv" >GetLootGUID</a>();</td></tr>
<tr><th id="37">37</th><td>    <a class="type" href="../Loot/LootMgr.h.html#Loot" title='Loot' data-ref="Loot" >Loot</a>* <dfn class="local col4 decl" id="4loot" title='loot' data-type='Loot *' data-ref="4loot" >loot</dfn> = <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="38">38</th><td>    <a class="typedef" href="../../../common/Define.h.html#uint8" title='uint8' data-type='uint8_t' data-ref="uint8" >uint8</a> <dfn class="local col5 decl" id="5lootSlot" title='lootSlot' data-type='uint8' data-ref="5lootSlot" >lootSlot</dfn> = <var>0</var>;</td></tr>
<tr><th id="39">39</th><td></td></tr>
<tr><th id="40">40</th><td>    <a class="local col1 ref" href="#1recvData" title='recvData' data-ref="1recvData" >recvData</a> <a class="ref" href="../../shared/Packets/ByteBuffer.h.html#_ZN10ByteBufferrsERh" title='ByteBuffer::operator&gt;&gt;' data-ref="_ZN10ByteBufferrsERh" id="_ZN10ByteBufferrsERh" >&gt;&gt;</a> <a class="local col5 ref" href="#5lootSlot" title='lootSlot' data-ref="5lootSlot" >lootSlot</a>;</td></tr>
<tr><th id="41">41</th><td></td></tr>
<tr><th id="42">42</th><td>    <b>if</b> (<a class="local col3 ref" href="#3lguid" title='lguid' data-ref="3lguid" >lguid</a>.<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuid12IsGameObjectEv" title='ObjectGuid::IsGameObject' data-ref="_ZNK10ObjectGuid12IsGameObjectEv" id="_ZNK10ObjectGuid12IsGameObjectEv" >IsGameObject</a>())</td></tr>
<tr><th id="43">43</th><td>    {</td></tr>
<tr><th id="44">44</th><td>        <a class="type" href="../Entities/GameObject/GameObject.h.html#GameObject" title='GameObject' data-ref="GameObject" >GameObject</a>* <dfn class="local col6 decl" id="6go" title='go' data-type='GameObject *' data-ref="6go" >go</dfn> = <a class="local col2 ref" href="#2player" title='player' data-ref="2player" >player</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject6GetMapEv" title='WorldObject::GetMap' data-ref="_ZNK11WorldObject6GetMapEv" id="_ZNK11WorldObject6GetMapEv" >GetMap</a>()-&gt;<a class="ref" href="../Maps/Map.h.html#_ZN3Map13GetGameObjectERK10ObjectGuid" title='Map::GetGameObject' data-ref="_ZN3Map13GetGameObjectERK10ObjectGuid" id="_ZN3Map13GetGameObjectERK10ObjectGuid" >GetGameObject</a>(<a class="local col3 ref" href="#3lguid" title='lguid' data-ref="3lguid" >lguid</a>);</td></tr>
<tr><th id="45">45</th><td></td></tr>
<tr><th id="46">46</th><td>        <i>// not check distance for GO in case owned GO (fishing bobber case, for example) or Fishing hole GO</i></td></tr>
<tr><th id="47">47</th><td>        <b>if</b> (!<a class="local col6 ref" href="#6go" title='go' data-ref="6go" >go</a> || ((<a class="local col6 ref" href="#6go" title='go' data-ref="6go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZNK10GameObject12GetOwnerGUIDEv" title='GameObject::GetOwnerGUID' data-ref="_ZNK10GameObject12GetOwnerGUIDEv" id="_ZNK10GameObject12GetOwnerGUIDEv" >GetOwnerGUID</a>() <a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuidneERKS_" title='ObjectGuid::operator!=' data-ref="_ZNK10ObjectGuidneERKS_" id="_ZNK10ObjectGuidneERKS_" >!=</a> <a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK6Object7GetGUIDEv" title='Object::GetGUID' data-ref="_ZNK6Object7GetGUIDEv" id="_ZNK6Object7GetGUIDEv" >GetGUID</a>() &amp;&amp; <a class="local col6 ref" href="#6go" title='go' data-ref="6go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZNK10GameObject9GetGoTypeEv" title='GameObject::GetGoType' data-ref="_ZNK10GameObject9GetGoTypeEv" id="_ZNK10GameObject9GetGoTypeEv" >GetGoType</a>() != <a class="enum" href="../Miscellaneous/SharedDefines.h.html#GameobjectTypes::GAMEOBJECT_TYPE_FISHINGHOLE" title='GameobjectTypes::GAMEOBJECT_TYPE_FISHINGHOLE' data-ref="GameobjectTypes::GAMEOBJECT_TYPE_FISHINGHOLE" id="GameobjectTypes::GAMEOBJECT_TYPE_FISHINGHOLE" >GAMEOBJECT_TYPE_FISHINGHOLE</a>) &amp;&amp; !<a class="local col6 ref" href="#6go" title='go' data-ref="6go" >go</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" title='WorldObject::IsWithinDistInMap' data-ref="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" id="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" >IsWithinDistInMap</a>(<a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>, <a class="macro" href="../Entities/Object/Object.h.html#34" title="5.0f" data-ref="_M/INTERACTION_DISTANCE">INTERACTION_DISTANCE</a>)))</td></tr>
<tr><th id="48">48</th><td>        {</td></tr>
<tr><th id="49">49</th><td>            <a class="local col2 ref" href="#2player" title='player' data-ref="2player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player15SendLootReleaseE10ObjectGuid" title='Player::SendLootRelease' data-ref="_ZN6Player15SendLootReleaseE10ObjectGuid" id="_ZN6Player15SendLootReleaseE10ObjectGuid" >SendLootRelease</a>(<a class="local col3 ref" href="#3lguid" title='lguid' data-ref="3lguid" >lguid</a>);</td></tr>
<tr><th id="50">50</th><td>            <b>return</b>;</td></tr>
<tr><th id="51">51</th><td>        }</td></tr>
<tr><th id="52">52</th><td></td></tr>
<tr><th id="53">53</th><td>        <a class="local col4 ref" href="#4loot" title='loot' data-ref="4loot" >loot</a> = &amp;<a class="local col6 ref" href="#6go" title='go' data-ref="6go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#GameObject::loot" title='GameObject::loot' data-ref="GameObject::loot" id="GameObject::loot" >loot</a>;</td></tr>
<tr><th id="54">54</th><td>    }</td></tr>
<tr><th id="55">55</th><td>    <b>else</b> <b>if</b> (<a class="local col3 ref" href="#3lguid" title='lguid' data-ref="3lguid" >lguid</a>.<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuid6IsItemEv" title='ObjectGuid::IsItem' data-ref="_ZNK10ObjectGuid6IsItemEv" id="_ZNK10ObjectGuid6IsItemEv" >IsItem</a>())</td></tr>
<tr><th id="56">56</th><td>    {</td></tr>
<tr><th id="57">57</th><td>        <a class="type" href="../Entities/Item/Item.h.html#Item" title='Item' data-ref="Item" >Item</a>* <dfn class="local col7 decl" id="7pItem" title='pItem' data-type='Item *' data-ref="7pItem" >pItem</dfn> = <a class="local col2 ref" href="#2player" title='player' data-ref="2player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZNK6Player13GetItemByGuidE10ObjectGuid" title='Player::GetItemByGuid' data-ref="_ZNK6Player13GetItemByGuidE10ObjectGuid" id="_ZNK6Player13GetItemByGuidE10ObjectGuid" >GetItemByGuid</a>(<a class="local col3 ref" href="#3lguid" title='lguid' data-ref="3lguid" >lguid</a>);</td></tr>
<tr><th id="58">58</th><td></td></tr>
<tr><th id="59">59</th><td>        <b>if</b> (!<a class="local col7 ref" href="#7pItem" title='pItem' data-ref="7pItem" >pItem</a>)</td></tr>
<tr><th id="60">60</th><td>        {</td></tr>
<tr><th id="61">61</th><td>            <a class="local col2 ref" href="#2player" title='player' data-ref="2player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player15SendLootReleaseE10ObjectGuid" title='Player::SendLootRelease' data-ref="_ZN6Player15SendLootReleaseE10ObjectGuid" id="_ZN6Player15SendLootReleaseE10ObjectGuid" >SendLootRelease</a>(<a class="local col3 ref" href="#3lguid" title='lguid' data-ref="3lguid" >lguid</a>);</td></tr>
<tr><th id="62">62</th><td>            <b>return</b>;</td></tr>
<tr><th id="63">63</th><td>        }</td></tr>
<tr><th id="64">64</th><td></td></tr>
<tr><th id="65">65</th><td>        <a class="local col4 ref" href="#4loot" title='loot' data-ref="4loot" >loot</a> = &amp;<a class="local col7 ref" href="#7pItem" title='pItem' data-ref="7pItem" >pItem</a>-&gt;<a class="ref" href="../Entities/Item/Item.h.html#Item::loot" title='Item::loot' data-ref="Item::loot" id="Item::loot" >loot</a>;</td></tr>
<tr><th id="66">66</th><td>    }</td></tr>
<tr><th id="67">67</th><td>    <b>else</b> <b>if</b> (<a class="local col3 ref" href="#3lguid" title='lguid' data-ref="3lguid" >lguid</a>.<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuid8IsCorpseEv" title='ObjectGuid::IsCorpse' data-ref="_ZNK10ObjectGuid8IsCorpseEv" id="_ZNK10ObjectGuid8IsCorpseEv" >IsCorpse</a>())</td></tr>
<tr><th id="68">68</th><td>    {</td></tr>
<tr><th id="69">69</th><td>        <a class="type" href="../Entities/Corpse/Corpse.h.html#Corpse" title='Corpse' data-ref="Corpse" >Corpse</a>* <dfn class="local col8 decl" id="8bones" title='bones' data-type='Corpse *' data-ref="8bones" >bones</dfn> = <span class="namespace">ObjectAccessor::</span><a class="ref" href="../Globals/ObjectAccessor.h.html#_ZN14ObjectAccessor9GetCorpseERK11WorldObjectRK10ObjectGuid" title='ObjectAccessor::GetCorpse' data-ref="_ZN14ObjectAccessor9GetCorpseERK11WorldObjectRK10ObjectGuid" id="_ZN14ObjectAccessor9GetCorpseERK11WorldObjectRK10ObjectGuid" >GetCorpse</a>(*<a class="local col2 ref" href="#2player" title='player' data-ref="2player" >player</a>, <a class="local col3 ref" href="#3lguid" title='lguid' data-ref="3lguid" >lguid</a>);</td></tr>
<tr><th id="70">70</th><td>        <b>if</b> (!<a class="local col8 ref" href="#8bones" title='bones' data-ref="8bones" >bones</a>)</td></tr>
<tr><th id="71">71</th><td>        {</td></tr>
<tr><th id="72">72</th><td>            <a class="local col2 ref" href="#2player" title='player' data-ref="2player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player15SendLootReleaseE10ObjectGuid" title='Player::SendLootRelease' data-ref="_ZN6Player15SendLootReleaseE10ObjectGuid" id="_ZN6Player15SendLootReleaseE10ObjectGuid" >SendLootRelease</a>(<a class="local col3 ref" href="#3lguid" title='lguid' data-ref="3lguid" >lguid</a>);</td></tr>
<tr><th id="73">73</th><td>            <b>return</b>;</td></tr>
<tr><th id="74">74</th><td>        }</td></tr>
<tr><th id="75">75</th><td></td></tr>
<tr><th id="76">76</th><td>        <a class="local col4 ref" href="#4loot" title='loot' data-ref="4loot" >loot</a> = &amp;<a class="local col8 ref" href="#8bones" title='bones' data-ref="8bones" >bones</a>-&gt;<a class="ref" href="../Entities/Corpse/Corpse.h.html#Corpse::loot" title='Corpse::loot' data-ref="Corpse::loot" id="Corpse::loot" >loot</a>;</td></tr>
<tr><th id="77">77</th><td>    }</td></tr>
<tr><th id="78">78</th><td>    <b>else</b></td></tr>
<tr><th id="79">79</th><td>    {</td></tr>
<tr><th id="80">80</th><td>        <a class="type" href="../Entities/Creature/Creature.h.html#Creature" title='Creature' data-ref="Creature" >Creature</a>* <dfn class="local col9 decl" id="9creature" title='creature' data-type='Creature *' data-ref="9creature" >creature</dfn> = <a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>()-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject6GetMapEv" title='WorldObject::GetMap' data-ref="_ZNK11WorldObject6GetMapEv" id="_ZNK11WorldObject6GetMapEv" >GetMap</a>()-&gt;<a class="ref" href="../Maps/Map.h.html#_ZN3Map11GetCreatureERK10ObjectGuid" title='Map::GetCreature' data-ref="_ZN3Map11GetCreatureERK10ObjectGuid" id="_ZN3Map11GetCreatureERK10ObjectGuid" >GetCreature</a>(<a class="local col3 ref" href="#3lguid" title='lguid' data-ref="3lguid" >lguid</a>);</td></tr>
<tr><th id="81">81</th><td></td></tr>
<tr><th id="82">82</th><td>        <em>bool</em> <dfn class="local col0 decl" id="10lootAllowed" title='lootAllowed' data-type='bool' data-ref="10lootAllowed" >lootAllowed</dfn> = <a class="local col9 ref" href="#9creature" title='creature' data-ref="9creature" >creature</a> &amp;&amp; <a class="local col9 ref" href="#9creature" title='creature' data-ref="9creature" >creature</a>-&gt;<a class="ref" href="../Entities/Unit/Unit.h.html#_ZNK4Unit7IsAliveEv" title='Unit::IsAlive' data-ref="_ZNK4Unit7IsAliveEv" id="_ZNK4Unit7IsAliveEv" >IsAlive</a>() == (<a class="local col2 ref" href="#2player" title='player' data-ref="2player" >player</a>-&gt;<a class="ref" href="../Entities/Unit/Unit.h.html#_ZNK4Unit8getClassEv" title='Unit::getClass' data-ref="_ZNK4Unit8getClassEv" id="_ZNK4Unit8getClassEv" >getClass</a>() == <a class="enum" href="../Miscellaneous/SharedDefines.h.html#Classes::CLASS_ROGUE" title='Classes::CLASS_ROGUE' data-ref="Classes::CLASS_ROGUE" id="Classes::CLASS_ROGUE" >CLASS_ROGUE</a> &amp;&amp; <a class="local col9 ref" href="#9creature" title='creature' data-ref="9creature" >creature</a>-&gt;<a class="ref" href="../Entities/Creature/Creature.h.html#Creature::loot" title='Creature::loot' data-ref="Creature::loot" id="Creature::loot" >loot</a>.<a class="ref" href="../Loot/LootMgr.h.html#Loot::loot_type" title='Loot::loot_type' data-ref="Loot::loot_type" id="Loot::loot_type" >loot_type</a> == <a class="enum" href="../Loot/LootMgr.h.html#LootType::LOOT_PICKPOCKETING" title='LootType::LOOT_PICKPOCKETING' data-ref="LootType::LOOT_PICKPOCKETING" id="LootType::LOOT_PICKPOCKETING" >LOOT_PICKPOCKETING</a>);</td></tr>
<tr><th id="83">83</th><td>        <b>if</b> (!<a class="local col0 ref" href="#10lootAllowed" title='lootAllowed' data-ref="10lootAllowed" >lootAllowed</a> || !<a class="local col9 ref" href="#9creature" title='creature' data-ref="9creature" >creature</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" title='WorldObject::IsWithinDistInMap' data-ref="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" id="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" >IsWithinDistInMap</a>(<a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>, <a class="macro" href="../Entities/Object/Object.h.html#34" title="5.0f" data-ref="_M/INTERACTION_DISTANCE">INTERACTION_DISTANCE</a>))</td></tr>
<tr><th id="84">84</th><td>        {</td></tr>
<tr><th id="85">85</th><td>            <a class="local col2 ref" href="#2player" title='player' data-ref="2player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player13SendLootErrorE10ObjectGuid9LootError" title='Player::SendLootError' data-ref="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" id="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" >SendLootError</a>(<a class="local col3 ref" href="#3lguid" title='lguid' data-ref="3lguid" >lguid</a>, <a class="local col0 ref" href="#10lootAllowed" title='lootAllowed' data-ref="10lootAllowed" >lootAllowed</a> ? <a class="enum" href="../Loot/LootMgr.h.html#LootError::LOOT_ERROR_TOO_FAR" title='LootError::LOOT_ERROR_TOO_FAR' data-ref="LootError::LOOT_ERROR_TOO_FAR" id="LootError::LOOT_ERROR_TOO_FAR" >LOOT_ERROR_TOO_FAR</a> : <a class="enum" href="../Loot/LootMgr.h.html#LootError::LOOT_ERROR_DIDNT_KILL" title='LootError::LOOT_ERROR_DIDNT_KILL' data-ref="LootError::LOOT_ERROR_DIDNT_KILL" id="LootError::LOOT_ERROR_DIDNT_KILL" >LOOT_ERROR_DIDNT_KILL</a>);</td></tr>
<tr><th id="86">86</th><td>            <b>return</b>;</td></tr>
<tr><th id="87">87</th><td>        }</td></tr>
<tr><th id="88">88</th><td></td></tr>
<tr><th id="89">89</th><td>        <a class="local col4 ref" href="#4loot" title='loot' data-ref="4loot" >loot</a> = &amp;<a class="local col9 ref" href="#9creature" title='creature' data-ref="9creature" >creature</a>-&gt;<a class="ref" href="../Entities/Creature/Creature.h.html#Creature::loot" title='Creature::loot' data-ref="Creature::loot" id="Creature::loot" >loot</a>;</td></tr>
<tr><th id="90">90</th><td>    }</td></tr>
<tr><th id="91">91</th><td></td></tr>
<tr><th id="92">92</th><td>    <a class="local col2 ref" href="#2player" title='player' data-ref="2player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player13StoreLootItemEhP4Loot" title='Player::StoreLootItem' data-ref="_ZN6Player13StoreLootItemEhP4Loot" id="_ZN6Player13StoreLootItemEhP4Loot" >StoreLootItem</a>(<a class="local col5 ref" href="#5lootSlot" title='lootSlot' data-ref="5lootSlot" >lootSlot</a>, <a class="local col4 ref" href="#4loot" title='loot' data-ref="4loot" >loot</a>);</td></tr>
<tr><th id="93">93</th><td></td></tr>
<tr><th id="94">94</th><td>    <i>// If player is removing the last LootItem, delete the empty container.</i></td></tr>
<tr><th id="95">95</th><td>    <b>if</b> (<a class="local col4 ref" href="#4loot" title='loot' data-ref="4loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#_ZNK4Loot8isLootedEv" title='Loot::isLooted' data-ref="_ZNK4Loot8isLootedEv" id="_ZNK4Loot8isLootedEv" >isLooted</a>() &amp;&amp; <a class="local col3 ref" href="#3lguid" title='lguid' data-ref="3lguid" >lguid</a>.<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuid6IsItemEv" title='ObjectGuid::IsItem' data-ref="_ZNK10ObjectGuid6IsItemEv" id="_ZNK10ObjectGuid6IsItemEv" >IsItem</a>())</td></tr>
<tr><th id="96">96</th><td>        <a class="local col2 ref" href="#2player" title='player' data-ref="2player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZNK6Player10GetSessionEv" title='Player::GetSession' data-ref="_ZNK6Player10GetSessionEv" id="_ZNK6Player10GetSessionEv" >GetSession</a>()-&gt;<a class="member" href="#_ZN12WorldSession13DoLootReleaseE10ObjectGuid" title='WorldSession::DoLootRelease' data-ref="_ZN12WorldSession13DoLootReleaseE10ObjectGuid" >DoLootRelease</a>(<a class="local col3 ref" href="#3lguid" title='lguid' data-ref="3lguid" >lguid</a>);</td></tr>
<tr><th id="97">97</th><td>}</td></tr>
<tr><th id="98">98</th><td></td></tr>
<tr><th id="99">99</th><td><em>void</em> <a class="type" href="../Server/WorldSession.h.html#WorldSession" title='WorldSession' data-ref="WorldSession" >WorldSession</a>::<dfn class="decl def" id="_ZN12WorldSession21HandleLootMoneyOpcodeER11WorldPacket" title='WorldSession::HandleLootMoneyOpcode' data-ref="_ZN12WorldSession21HandleLootMoneyOpcodeER11WorldPacket" >HandleLootMoneyOpcode</dfn>(<a class="type" href="../../shared/Packets/WorldPacket.h.html#WorldPacket" title='WorldPacket' data-ref="WorldPacket" >WorldPacket</a>&amp; <i>/*recvData*/</i>)</td></tr>
<tr><th id="100">100</th><td>{</td></tr>
<tr><th id="101">101</th><td>    <a class="macro" href="../../../common/Logging/Log.h.html#201" title="do { if (Log::instance()-&gt;ShouldLog(&quot;network&quot;, LOG_LEVEL_DEBUG)) { if (false) check_args(&quot;WORLD: CMSG_LOOT_MONEY&quot;); { try { Log::instance()-&gt;outMessage(&quot;network&quot;, LOG_LEVEL_DEBUG, &quot;WORLD: CMSG_LOOT_MONEY&quot;); } catch (std::exception&amp; e) { Log::instance()-&gt;outMessage(&quot;server&quot;, LOG_LEVEL_ERROR, &quot;Wrong format occurred (%s) at %s:%u.&quot;, e.what(), &quot;/home/nayd/TrinityCore/src/server/game/Handlers/LootHandler.cpp&quot;, 101); } }; } } while (0)" data-ref="_M/TC_LOG_DEBUG">TC_LOG_DEBUG</a>(<q>"network"</q>, <q>"WORLD: CMSG_LOOT_MONEY"</q>);</td></tr>
<tr><th id="102">102</th><td></td></tr>
<tr><th id="103">103</th><td>    <a class="type" href="../Entities/Player/Player.h.html#Player" title='Player' data-ref="Player" >Player</a>* <dfn class="local col1 decl" id="11player" title='player' data-type='Player *' data-ref="11player" >player</dfn> = <a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>();</td></tr>
<tr><th id="104">104</th><td>    <a class="type" href="../Entities/Object/ObjectGuid.h.html#ObjectGuid" title='ObjectGuid' data-ref="ObjectGuid" >ObjectGuid</a> <dfn class="local col2 decl" id="12guid" title='guid' data-type='ObjectGuid' data-ref="12guid" >guid</dfn> = <a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZNK6Player11GetLootGUIDEv" title='Player::GetLootGUID' data-ref="_ZNK6Player11GetLootGUIDEv" id="_ZNK6Player11GetLootGUIDEv" >GetLootGUID</a>();</td></tr>
<tr><th id="105">105</th><td>    <b>if</b> (<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuidntEv" title='ObjectGuid::operator!' data-ref="_ZNK10ObjectGuidntEv" id="_ZNK10ObjectGuidntEv" >!</a><a class="local col2 ref" href="#12guid" title='guid' data-ref="12guid" >guid</a>)</td></tr>
<tr><th id="106">106</th><td>        <b>return</b>;</td></tr>
<tr><th id="107">107</th><td></td></tr>
<tr><th id="108">108</th><td>    <a class="type" href="../Loot/LootMgr.h.html#Loot" title='Loot' data-ref="Loot" >Loot</a>* <dfn class="local col3 decl" id="13loot" title='loot' data-type='Loot *' data-ref="13loot" >loot</dfn> = <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="109">109</th><td>    <em>bool</em> <dfn class="local col4 decl" id="14shareMoney" title='shareMoney' data-type='bool' data-ref="14shareMoney" >shareMoney</dfn> = <b>true</b>;</td></tr>
<tr><th id="110">110</th><td></td></tr>
<tr><th id="111">111</th><td>    <b>switch</b> (<a class="local col2 ref" href="#12guid" title='guid' data-ref="12guid" >guid</a>.<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuid7GetHighEv" title='ObjectGuid::GetHigh' data-ref="_ZNK10ObjectGuid7GetHighEv" id="_ZNK10ObjectGuid7GetHighEv" >GetHigh</a>())</td></tr>
<tr><th id="112">112</th><td>    {</td></tr>
<tr><th id="113">113</th><td>        <b>case</b> <a class="type" href="../Entities/Object/ObjectGuid.h.html#HighGuid" title='HighGuid' data-ref="HighGuid" >HighGuid</a>::<a class="enum" href="../Entities/Object/ObjectGuid.h.html#HighGuid::GameObject" title='HighGuid::GameObject' data-ref="HighGuid::GameObject" >GameObject</a>:</td></tr>
<tr><th id="114">114</th><td>        {</td></tr>
<tr><th id="115">115</th><td>            <a class="type" href="../Entities/GameObject/GameObject.h.html#GameObject" title='GameObject' data-ref="GameObject" >GameObject</a>* <dfn class="local col5 decl" id="15go" title='go' data-type='GameObject *' data-ref="15go" >go</dfn> = <a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>()-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject6GetMapEv" title='WorldObject::GetMap' data-ref="_ZNK11WorldObject6GetMapEv" id="_ZNK11WorldObject6GetMapEv" >GetMap</a>()-&gt;<a class="ref" href="../Maps/Map.h.html#_ZN3Map13GetGameObjectERK10ObjectGuid" title='Map::GetGameObject' data-ref="_ZN3Map13GetGameObjectERK10ObjectGuid" id="_ZN3Map13GetGameObjectERK10ObjectGuid" >GetGameObject</a>(<a class="local col2 ref" href="#12guid" title='guid' data-ref="12guid" >guid</a>);</td></tr>
<tr><th id="116">116</th><td></td></tr>
<tr><th id="117">117</th><td>            <i>// do not check distance for GO if player is the owner of it (ex. fishing bobber)</i></td></tr>
<tr><th id="118">118</th><td>            <b>if</b> (<a class="local col5 ref" href="#15go" title='go' data-ref="15go" >go</a> &amp;&amp; ((<a class="local col5 ref" href="#15go" title='go' data-ref="15go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZNK10GameObject12GetOwnerGUIDEv" title='GameObject::GetOwnerGUID' data-ref="_ZNK10GameObject12GetOwnerGUIDEv" id="_ZNK10GameObject12GetOwnerGUIDEv" >GetOwnerGUID</a>() <a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuideqERKS_" title='ObjectGuid::operator==' data-ref="_ZNK10ObjectGuideqERKS_" id="_ZNK10ObjectGuideqERKS_" >==</a> <a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK6Object7GetGUIDEv" title='Object::GetGUID' data-ref="_ZNK6Object7GetGUIDEv" id="_ZNK6Object7GetGUIDEv" >GetGUID</a>() || <a class="local col5 ref" href="#15go" title='go' data-ref="15go" >go</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" title='WorldObject::IsWithinDistInMap' data-ref="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" id="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" >IsWithinDistInMap</a>(<a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>, <a class="macro" href="../Entities/Object/Object.h.html#34" title="5.0f" data-ref="_M/INTERACTION_DISTANCE">INTERACTION_DISTANCE</a>))))</td></tr>
<tr><th id="119">119</th><td>                <a class="local col3 ref" href="#13loot" title='loot' data-ref="13loot" >loot</a> = &amp;<a class="local col5 ref" href="#15go" title='go' data-ref="15go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#GameObject::loot" title='GameObject::loot' data-ref="GameObject::loot" id="GameObject::loot" >loot</a>;</td></tr>
<tr><th id="120">120</th><td></td></tr>
<tr><th id="121">121</th><td>            <b>break</b>;</td></tr>
<tr><th id="122">122</th><td>        }</td></tr>
<tr><th id="123">123</th><td>        <b>case</b> <a class="type" href="../Entities/Object/ObjectGuid.h.html#HighGuid" title='HighGuid' data-ref="HighGuid" >HighGuid</a>::<a class="enum" href="../Entities/Object/ObjectGuid.h.html#HighGuid::Corpse" title='HighGuid::Corpse' data-ref="HighGuid::Corpse" >Corpse</a>:                               <i>// remove insignia ONLY in BG</i></td></tr>
<tr><th id="124">124</th><td>        {</td></tr>
<tr><th id="125">125</th><td>            <a class="type" href="../Entities/Corpse/Corpse.h.html#Corpse" title='Corpse' data-ref="Corpse" >Corpse</a>* <dfn class="local col6 decl" id="16bones" title='bones' data-type='Corpse *' data-ref="16bones" >bones</dfn> = <span class="namespace">ObjectAccessor::</span><a class="ref" href="../Globals/ObjectAccessor.h.html#_ZN14ObjectAccessor9GetCorpseERK11WorldObjectRK10ObjectGuid" title='ObjectAccessor::GetCorpse' data-ref="_ZN14ObjectAccessor9GetCorpseERK11WorldObjectRK10ObjectGuid" id="_ZN14ObjectAccessor9GetCorpseERK11WorldObjectRK10ObjectGuid" >GetCorpse</a>(*<a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>, <a class="local col2 ref" href="#12guid" title='guid' data-ref="12guid" >guid</a>);</td></tr>
<tr><th id="126">126</th><td></td></tr>
<tr><th id="127">127</th><td>            <b>if</b> (<a class="local col6 ref" href="#16bones" title='bones' data-ref="16bones" >bones</a> &amp;&amp; <a class="local col6 ref" href="#16bones" title='bones' data-ref="16bones" >bones</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" title='WorldObject::IsWithinDistInMap' data-ref="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" id="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" >IsWithinDistInMap</a>(<a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>, <a class="macro" href="../Entities/Object/Object.h.html#34" title="5.0f" data-ref="_M/INTERACTION_DISTANCE">INTERACTION_DISTANCE</a>))</td></tr>
<tr><th id="128">128</th><td>            {</td></tr>
<tr><th id="129">129</th><td>                <a class="local col3 ref" href="#13loot" title='loot' data-ref="13loot" >loot</a> = &amp;<a class="local col6 ref" href="#16bones" title='bones' data-ref="16bones" >bones</a>-&gt;<a class="ref" href="../Entities/Corpse/Corpse.h.html#Corpse::loot" title='Corpse::loot' data-ref="Corpse::loot" id="Corpse::loot" >loot</a>;</td></tr>
<tr><th id="130">130</th><td>                <a class="local col4 ref" href="#14shareMoney" title='shareMoney' data-ref="14shareMoney" >shareMoney</a> = <b>false</b>;</td></tr>
<tr><th id="131">131</th><td>            }</td></tr>
<tr><th id="132">132</th><td></td></tr>
<tr><th id="133">133</th><td>            <b>break</b>;</td></tr>
<tr><th id="134">134</th><td>        }</td></tr>
<tr><th id="135">135</th><td>        <b>case</b> <a class="type" href="../Entities/Object/ObjectGuid.h.html#HighGuid" title='HighGuid' data-ref="HighGuid" >HighGuid</a>::<a class="enum" href="../Entities/Object/ObjectGuid.h.html#HighGuid::Item" title='HighGuid::Item' data-ref="HighGuid::Item" >Item</a>:</td></tr>
<tr><th id="136">136</th><td>        {</td></tr>
<tr><th id="137">137</th><td>            <b>if</b> (<a class="type" href="../Entities/Item/Item.h.html#Item" title='Item' data-ref="Item" >Item</a>* <dfn class="local col7 decl" id="17item" title='item' data-type='Item *' data-ref="17item" ><a class="local col7 ref" href="#17item" title='item' data-ref="17item" >item</a></dfn> = <a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZNK6Player13GetItemByGuidE10ObjectGuid" title='Player::GetItemByGuid' data-ref="_ZNK6Player13GetItemByGuidE10ObjectGuid" id="_ZNK6Player13GetItemByGuidE10ObjectGuid" >GetItemByGuid</a>(<a class="local col2 ref" href="#12guid" title='guid' data-ref="12guid" >guid</a>))</td></tr>
<tr><th id="138">138</th><td>            {</td></tr>
<tr><th id="139">139</th><td>                <a class="local col3 ref" href="#13loot" title='loot' data-ref="13loot" >loot</a> = &amp;<a class="local col7 ref" href="#17item" title='item' data-ref="17item" >item</a>-&gt;<a class="ref" href="../Entities/Item/Item.h.html#Item::loot" title='Item::loot' data-ref="Item::loot" id="Item::loot" >loot</a>;</td></tr>
<tr><th id="140">140</th><td>                <a class="local col4 ref" href="#14shareMoney" title='shareMoney' data-ref="14shareMoney" >shareMoney</a> = <b>false</b>;</td></tr>
<tr><th id="141">141</th><td>            }</td></tr>
<tr><th id="142">142</th><td>            <b>break</b>;</td></tr>
<tr><th id="143">143</th><td>        }</td></tr>
<tr><th id="144">144</th><td>        <b>case</b> <a class="type" href="../Entities/Object/ObjectGuid.h.html#HighGuid" title='HighGuid' data-ref="HighGuid" >HighGuid</a>::<a class="enum" href="../Entities/Object/ObjectGuid.h.html#HighGuid::Unit" title='HighGuid::Unit' data-ref="HighGuid::Unit" >Unit</a>:</td></tr>
<tr><th id="145">145</th><td>        <b>case</b> <a class="type" href="../Entities/Object/ObjectGuid.h.html#HighGuid" title='HighGuid' data-ref="HighGuid" >HighGuid</a>::<a class="enum" href="../Entities/Object/ObjectGuid.h.html#HighGuid::Vehicle" title='HighGuid::Vehicle' data-ref="HighGuid::Vehicle" >Vehicle</a>:</td></tr>
<tr><th id="146">146</th><td>        {</td></tr>
<tr><th id="147">147</th><td>            <a class="type" href="../Entities/Creature/Creature.h.html#Creature" title='Creature' data-ref="Creature" >Creature</a>* <dfn class="local col8 decl" id="18creature" title='creature' data-type='Creature *' data-ref="18creature" >creature</dfn> = <a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject6GetMapEv" title='WorldObject::GetMap' data-ref="_ZNK11WorldObject6GetMapEv" id="_ZNK11WorldObject6GetMapEv" >GetMap</a>()-&gt;<a class="ref" href="../Maps/Map.h.html#_ZN3Map11GetCreatureERK10ObjectGuid" title='Map::GetCreature' data-ref="_ZN3Map11GetCreatureERK10ObjectGuid" id="_ZN3Map11GetCreatureERK10ObjectGuid" >GetCreature</a>(<a class="local col2 ref" href="#12guid" title='guid' data-ref="12guid" >guid</a>);</td></tr>
<tr><th id="148">148</th><td>            <em>bool</em> <dfn class="local col9 decl" id="19lootAllowed" title='lootAllowed' data-type='bool' data-ref="19lootAllowed" >lootAllowed</dfn> = <a class="local col8 ref" href="#18creature" title='creature' data-ref="18creature" >creature</a> &amp;&amp; <a class="local col8 ref" href="#18creature" title='creature' data-ref="18creature" >creature</a>-&gt;<a class="ref" href="../Entities/Unit/Unit.h.html#_ZNK4Unit7IsAliveEv" title='Unit::IsAlive' data-ref="_ZNK4Unit7IsAliveEv" id="_ZNK4Unit7IsAliveEv" >IsAlive</a>() == (<a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>-&gt;<a class="ref" href="../Entities/Unit/Unit.h.html#_ZNK4Unit8getClassEv" title='Unit::getClass' data-ref="_ZNK4Unit8getClassEv" id="_ZNK4Unit8getClassEv" >getClass</a>() == <a class="enum" href="../Miscellaneous/SharedDefines.h.html#Classes::CLASS_ROGUE" title='Classes::CLASS_ROGUE' data-ref="Classes::CLASS_ROGUE" id="Classes::CLASS_ROGUE" >CLASS_ROGUE</a> &amp;&amp; <a class="local col8 ref" href="#18creature" title='creature' data-ref="18creature" >creature</a>-&gt;<a class="ref" href="../Entities/Creature/Creature.h.html#Creature::loot" title='Creature::loot' data-ref="Creature::loot" id="Creature::loot" >loot</a>.<a class="ref" href="../Loot/LootMgr.h.html#Loot::loot_type" title='Loot::loot_type' data-ref="Loot::loot_type" id="Loot::loot_type" >loot_type</a> == <a class="enum" href="../Loot/LootMgr.h.html#LootType::LOOT_PICKPOCKETING" title='LootType::LOOT_PICKPOCKETING' data-ref="LootType::LOOT_PICKPOCKETING" id="LootType::LOOT_PICKPOCKETING" >LOOT_PICKPOCKETING</a>);</td></tr>
<tr><th id="149">149</th><td>            <b>if</b> (<a class="local col9 ref" href="#19lootAllowed" title='lootAllowed' data-ref="19lootAllowed" >lootAllowed</a> &amp;&amp; <a class="local col8 ref" href="#18creature" title='creature' data-ref="18creature" >creature</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" title='WorldObject::IsWithinDistInMap' data-ref="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" id="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" >IsWithinDistInMap</a>(<a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>, <a class="macro" href="../Entities/Object/Object.h.html#34" title="5.0f" data-ref="_M/INTERACTION_DISTANCE">INTERACTION_DISTANCE</a>))</td></tr>
<tr><th id="150">150</th><td>            {</td></tr>
<tr><th id="151">151</th><td>                <a class="local col3 ref" href="#13loot" title='loot' data-ref="13loot" >loot</a> = &amp;<a class="local col8 ref" href="#18creature" title='creature' data-ref="18creature" >creature</a>-&gt;<a class="ref" href="../Entities/Creature/Creature.h.html#Creature::loot" title='Creature::loot' data-ref="Creature::loot" id="Creature::loot" >loot</a>;</td></tr>
<tr><th id="152">152</th><td>                <b>if</b> (<a class="local col8 ref" href="#18creature" title='creature' data-ref="18creature" >creature</a>-&gt;<a class="ref" href="../Entities/Unit/Unit.h.html#_ZNK4Unit7IsAliveEv" title='Unit::IsAlive' data-ref="_ZNK4Unit7IsAliveEv" id="_ZNK4Unit7IsAliveEv" >IsAlive</a>())</td></tr>
<tr><th id="153">153</th><td>                    <a class="local col4 ref" href="#14shareMoney" title='shareMoney' data-ref="14shareMoney" >shareMoney</a> = <b>false</b>;</td></tr>
<tr><th id="154">154</th><td>            }</td></tr>
<tr><th id="155">155</th><td>            <b>else</b></td></tr>
<tr><th id="156">156</th><td>                <a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player13SendLootErrorE10ObjectGuid9LootError" title='Player::SendLootError' data-ref="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" id="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" >SendLootError</a>(<a class="local col2 ref" href="#12guid" title='guid' data-ref="12guid" >guid</a>, <a class="local col9 ref" href="#19lootAllowed" title='lootAllowed' data-ref="19lootAllowed" >lootAllowed</a> ? <a class="enum" href="../Loot/LootMgr.h.html#LootError::LOOT_ERROR_TOO_FAR" title='LootError::LOOT_ERROR_TOO_FAR' data-ref="LootError::LOOT_ERROR_TOO_FAR" id="LootError::LOOT_ERROR_TOO_FAR" >LOOT_ERROR_TOO_FAR</a> : <a class="enum" href="../Loot/LootMgr.h.html#LootError::LOOT_ERROR_DIDNT_KILL" title='LootError::LOOT_ERROR_DIDNT_KILL' data-ref="LootError::LOOT_ERROR_DIDNT_KILL" id="LootError::LOOT_ERROR_DIDNT_KILL" >LOOT_ERROR_DIDNT_KILL</a>);</td></tr>
<tr><th id="157">157</th><td>            <b>break</b>;</td></tr>
<tr><th id="158">158</th><td>        }</td></tr>
<tr><th id="159">159</th><td>        <b>default</b>:</td></tr>
<tr><th id="160">160</th><td>            <b>return</b>;                                         <i>// unlootable type</i></td></tr>
<tr><th id="161">161</th><td>    }</td></tr>
<tr><th id="162">162</th><td></td></tr>
<tr><th id="163">163</th><td>    <b>if</b> (<a class="local col3 ref" href="#13loot" title='loot' data-ref="13loot" >loot</a>)</td></tr>
<tr><th id="164">164</th><td>    {</td></tr>
<tr><th id="165">165</th><td>        <a class="local col3 ref" href="#13loot" title='loot' data-ref="13loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#_ZN4Loot18NotifyMoneyRemovedEv" title='Loot::NotifyMoneyRemoved' data-ref="_ZN4Loot18NotifyMoneyRemovedEv" id="_ZN4Loot18NotifyMoneyRemovedEv" >NotifyMoneyRemoved</a>();</td></tr>
<tr><th id="166">166</th><td>        <b>if</b> (<a class="local col4 ref" href="#14shareMoney" title='shareMoney' data-ref="14shareMoney" >shareMoney</a> &amp;&amp; <a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player8GetGroupEv" title='Player::GetGroup' data-ref="_ZN6Player8GetGroupEv" id="_ZN6Player8GetGroupEv" >GetGroup</a>())      <i>//item, pickpocket and players can be looted only single player</i></td></tr>
<tr><th id="167">167</th><td>        {</td></tr>
<tr><th id="168">168</th><td>            <a class="type" href="../Groups/Group.h.html#Group" title='Group' data-ref="Group" >Group</a>* <dfn class="local col0 decl" id="20group" title='group' data-type='Group *' data-ref="20group" >group</dfn> = <a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player8GetGroupEv" title='Player::GetGroup' data-ref="_ZN6Player8GetGroupEv" id="_ZN6Player8GetGroupEv" >GetGroup</a>();</td></tr>
<tr><th id="169">169</th><td></td></tr>
<tr><th id="170">170</th><td>            <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector" >vector</a>&lt;<a class="type" href="../Entities/Player/Player.h.html#Player" title='Player' data-ref="Player" >Player</a>*&gt; <dfn class="local col1 decl" id="21playersNear" title='playersNear' data-type='std::vector&lt;Player *&gt;' data-ref="21playersNear" >playersNear</dfn>;</td></tr>
<tr><th id="171">171</th><td>            <b>for</b> (<a class="type" href="../Groups/GroupReference.h.html#GroupReference" title='GroupReference' data-ref="GroupReference" >GroupReference</a>* <dfn class="local col2 decl" id="22itr" title='itr' data-type='GroupReference *' data-ref="22itr" >itr</dfn> = <a class="local col0 ref" href="#20group" title='group' data-ref="20group" >group</a>-&gt;<a class="ref" href="../Groups/Group.h.html#_ZN5Group14GetFirstMemberEv" title='Group::GetFirstMember' data-ref="_ZN5Group14GetFirstMemberEv" id="_ZN5Group14GetFirstMemberEv" >GetFirstMember</a>(); <a class="local col2 ref" href="#22itr" title='itr' data-ref="22itr" >itr</a> != <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>; <a class="local col2 ref" href="#22itr" title='itr' data-ref="22itr" >itr</a> = <a class="local col2 ref" href="#22itr" title='itr' data-ref="22itr" >itr</a>-&gt;<a class="ref" href="../Groups/GroupReference.h.html#_ZN14GroupReference4nextEv" title='GroupReference::next' data-ref="_ZN14GroupReference4nextEv" id="_ZN14GroupReference4nextEv" >next</a>())</td></tr>
<tr><th id="172">172</th><td>            {</td></tr>
<tr><th id="173">173</th><td>                <a class="type" href="../Entities/Player/Player.h.html#Player" title='Player' data-ref="Player" >Player</a>* <dfn class="local col3 decl" id="23member" title='member' data-type='Player *' data-ref="23member" >member</dfn> = <a class="local col2 ref" href="#22itr" title='itr' data-ref="22itr" >itr</a>-&gt;<a class="ref" href="../../shared/Dynamic/LinkedReference/Reference.h.html#_ZNK9Reference9GetSourceEv" title='Reference::GetSource' data-ref="_ZNK9Reference9GetSourceEv" id="_ZNK9Reference9GetSourceEv" >GetSource</a>();</td></tr>
<tr><th id="174">174</th><td>                <b>if</b> (!<a class="local col3 ref" href="#23member" title='member' data-ref="23member" >member</a>)</td></tr>
<tr><th id="175">175</th><td>                    <b>continue</b>;</td></tr>
<tr><th id="176">176</th><td></td></tr>
<tr><th id="177">177</th><td>                <b>if</b> (<a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZNK6Player23IsAtGroupRewardDistanceEPK11WorldObject" title='Player::IsAtGroupRewardDistance' data-ref="_ZNK6Player23IsAtGroupRewardDistanceEPK11WorldObject" id="_ZNK6Player23IsAtGroupRewardDistanceEPK11WorldObject" >IsAtGroupRewardDistance</a>(<a class="local col3 ref" href="#23member" title='member' data-ref="23member" >member</a>))</td></tr>
<tr><th id="178">178</th><td>                    <a class="local col1 ref" href="#21playersNear" title='playersNear' data-ref="21playersNear" >playersNear</a>.<a class="ref" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#_ZNSt6vector9push_backERKT_" title='std::vector::push_back' data-ref="_ZNSt6vector9push_backERKT_" id="_ZNSt6vector9push_backERKT_" >push_back</a>(<a class="local col3 ref" href="#23member" title='member' data-ref="23member" >member</a>);</td></tr>
<tr><th id="179">179</th><td>            }</td></tr>
<tr><th id="180">180</th><td></td></tr>
<tr><th id="181">181</th><td>            <a class="typedef" href="../../../common/Define.h.html#uint32" title='uint32' data-type='uint32_t' data-ref="uint32" >uint32</a> <dfn class="local col4 decl" id="24goldPerPlayer" title='goldPerPlayer' data-type='uint32' data-ref="24goldPerPlayer" >goldPerPlayer</dfn> = <a class="typedef" href="../../../common/Define.h.html#uint32" title='uint32' data-type='uint32_t' data-ref="uint32" >uint32</a>((<a class="local col3 ref" href="#13loot" title='loot' data-ref="13loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::gold" title='Loot::gold' data-ref="Loot::gold" id="Loot::gold" >gold</a>) / (<a class="local col1 ref" href="#21playersNear" title='playersNear' data-ref="21playersNear" >playersNear</a>.<a class="ref" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv" id="_ZNKSt6vector4sizeEv" >size</a>()));</td></tr>
<tr><th id="182">182</th><td></td></tr>
<tr><th id="183">183</th><td>            <b>for</b> (<span class="namespace">std::</span><a class="type" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector" >vector</a>&lt;<a class="type" href="../Entities/Player/Player.h.html#Player" title='Player' data-ref="Player" >Player</a>*&gt;::<a class="typedef" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#std::vector{Player*,std::allocator{Player*}}::const_iterator" title='std::vector&lt;Player *, std::allocator&lt;Player *&gt; &gt;::const_iterator' data-type='__gnu_cxx::__normal_iterator&lt;const_pointer, vector&lt;Player *, allocator&lt;Player *&gt; &gt; &gt;' data-ref="std::vector{Player*,std::allocator{Player*}}::const_iterator" >const_iterator</a> <dfn class="local col5 decl" id="25i" title='i' data-type='std::vector&lt;Player *&gt;::const_iterator' data-ref="25i" >i</dfn> = <a class="local col1 ref" href="#21playersNear" title='playersNear' data-ref="21playersNear" >playersNear</a>.<a class="ref" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#_ZNSt6vector5beginEv" title='std::vector::begin' data-ref="_ZNSt6vector5beginEv" id="_ZNSt6vector5beginEv" >begin</a>(); <a class="local col5 ref" href="#25i" title='i' data-ref="25i" >i</a> <a class="ref" href="../../../../../include/c++/4.9/bits/stl_iterator.h.html#__gnu_cxx::operator!=" title='__gnu_cxx::operator!=' data-ref="__gnu_cxx::operator!=" id="__gnu_cxx::operator!=" >!=</a> <a class="local col1 ref" href="#21playersNear" title='playersNear' data-ref="21playersNear" >playersNear</a>.<a class="ref" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#_ZNSt6vector3endEv" title='std::vector::end' data-ref="_ZNSt6vector3endEv" id="_ZNSt6vector3endEv" >end</a>(); <a class="ref" href="../../../../../include/c++/4.9/bits/stl_iterator.h.html#__gnu_cxx::__normal_iterator::operator++" title='__gnu_cxx::__normal_iterator::operator++' data-ref="__gnu_cxx::__normal_iterator::operator++" id="__gnu_cxx::__normal_iterator::operator++" >++</a><a class="local col5 ref" href="#25i" title='i' data-ref="25i" >i</a>)</td></tr>
<tr><th id="184">184</th><td>            {</td></tr>
<tr><th id="185">185</th><td>                (<a class="ref" href="../../../../../include/c++/4.9/bits/stl_iterator.h.html#__gnu_cxx::__normal_iterator::operator*" title='__gnu_cxx::__normal_iterator::operator*' data-ref="__gnu_cxx::__normal_iterator::operator*" id="__gnu_cxx::__normal_iterator::operator*" >*</a><a class="local col5 ref" href="#25i" title='i' data-ref="25i" >i</a>)-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player11ModifyMoneyEib" title='Player::ModifyMoney' data-ref="_ZN6Player11ModifyMoneyEib" id="_ZN6Player11ModifyMoneyEib" >ModifyMoney</a>(<a class="local col4 ref" href="#24goldPerPlayer" title='goldPerPlayer' data-ref="24goldPerPlayer" >goldPerPlayer</a>);</td></tr>
<tr><th id="186">186</th><td>                (<a class="ref" href="../../../../../include/c++/4.9/bits/stl_iterator.h.html#__gnu_cxx::__normal_iterator::operator*" title='__gnu_cxx::__normal_iterator::operator*' data-ref="__gnu_cxx::__normal_iterator::operator*" id="__gnu_cxx::__normal_iterator::operator*" >*</a><a class="local col5 ref" href="#25i" title='i' data-ref="25i" >i</a>)-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player25UpdateAchievementCriteriaE24AchievementCriteriaTypesjjP4Unit" title='Player::UpdateAchievementCriteria' data-ref="_ZN6Player25UpdateAchievementCriteriaE24AchievementCriteriaTypesjjP4Unit" id="_ZN6Player25UpdateAchievementCriteriaE24AchievementCriteriaTypesjjP4Unit" >UpdateAchievementCriteria</a>(<a class="enum" href="../DataStores/DBCEnums.h.html#AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_MONEY" title='AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_MONEY' data-ref="AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_MONEY" id="AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_MONEY" >ACHIEVEMENT_CRITERIA_TYPE_LOOT_MONEY</a>, <a class="local col4 ref" href="#24goldPerPlayer" title='goldPerPlayer' data-ref="24goldPerPlayer" >goldPerPlayer</a>);</td></tr>
<tr><th id="187">187</th><td></td></tr>
<tr><th id="188">188</th><td>                <a class="type" href="../../shared/Packets/WorldPacket.h.html#WorldPacket" title='WorldPacket' data-ref="WorldPacket" >WorldPacket</a> <dfn class="local col6 decl" id="26data" title='data' data-type='WorldPacket' data-ref="26data" >data</dfn><a class="ref" href="../../shared/Packets/WorldPacket.h.html#_ZN11WorldPacketC1Etm" title='WorldPacket::WorldPacket' data-ref="_ZN11WorldPacketC1Etm" id="_ZN11WorldPacketC1Etm" >(</a><a class="enum" href="../Server/Protocol/Opcodes.h.html#Opcodes::SMSG_LOOT_MONEY_NOTIFY" title='Opcodes::SMSG_LOOT_MONEY_NOTIFY' data-ref="Opcodes::SMSG_LOOT_MONEY_NOTIFY" id="Opcodes::SMSG_LOOT_MONEY_NOTIFY" >SMSG_LOOT_MONEY_NOTIFY</a>, <var>4</var> + <var>1</var>);</td></tr>
<tr><th id="189">189</th><td>                <a class="local col6 ref" href="#26data" title='data' data-ref="26data" >data</a> <a class="ref" href="../../shared/Packets/ByteBuffer.h.html#_ZN10ByteBufferlsEj" title='ByteBuffer::operator&lt;&lt;' data-ref="_ZN10ByteBufferlsEj" id="_ZN10ByteBufferlsEj" >&lt;&lt;</a> <a class="typedef" href="../../../common/Define.h.html#uint32" title='uint32' data-type='uint32_t' data-ref="uint32" >uint32</a>(<a class="local col4 ref" href="#24goldPerPlayer" title='goldPerPlayer' data-ref="24goldPerPlayer" >goldPerPlayer</a>);</td></tr>
<tr><th id="190">190</th><td>                <a class="local col6 ref" href="#26data" title='data' data-ref="26data" >data</a> <a class="ref" href="../../shared/Packets/ByteBuffer.h.html#_ZN10ByteBufferlsEh" title='ByteBuffer::operator&lt;&lt;' data-ref="_ZN10ByteBufferlsEh" id="_ZN10ByteBufferlsEh" >&lt;&lt;</a> <a class="typedef" href="../../../common/Define.h.html#uint8" title='uint8' data-type='uint8_t' data-ref="uint8" >uint8</a>(<a class="local col1 ref" href="#21playersNear" title='playersNear' data-ref="21playersNear" >playersNear</a>.<a class="ref" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv" id="_ZNKSt6vector4sizeEv" >size</a>() &lt;= <var>1</var>); <i>// Controls the text displayed in chat. 0 is "Your share is..." and 1 is "You loot..."</i></td></tr>
<tr><th id="191">191</th><td>                (<a class="ref" href="../../../../../include/c++/4.9/bits/stl_iterator.h.html#__gnu_cxx::__normal_iterator::operator*" title='__gnu_cxx::__normal_iterator::operator*' data-ref="__gnu_cxx::__normal_iterator::operator*" id="__gnu_cxx::__normal_iterator::operator*" >*</a><a class="local col5 ref" href="#25i" title='i' data-ref="25i" >i</a>)-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZNK6Player10GetSessionEv" title='Player::GetSession' data-ref="_ZNK6Player10GetSessionEv" id="_ZNK6Player10GetSessionEv" >GetSession</a>()-&gt;<a class="member" href="../Server/WorldSession.h.html#_ZN12WorldSession10SendPacketEP11WorldPacket" title='WorldSession::SendPacket' data-ref="_ZN12WorldSession10SendPacketEP11WorldPacket" id="_ZN12WorldSession10SendPacketEP11WorldPacket" >SendPacket</a>(&amp;<a class="local col6 ref" href="#26data" title='data' data-ref="26data" >data</a>);</td></tr>
<tr><th id="192">192</th><td>            }</td></tr>
<tr><th id="193">193</th><td>        }</td></tr>
<tr><th id="194">194</th><td>        <b>else</b></td></tr>
<tr><th id="195">195</th><td>        {</td></tr>
<tr><th id="196">196</th><td>            <a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player11ModifyMoneyEib" title='Player::ModifyMoney' data-ref="_ZN6Player11ModifyMoneyEib" id="_ZN6Player11ModifyMoneyEib" >ModifyMoney</a>(<a class="local col3 ref" href="#13loot" title='loot' data-ref="13loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::gold" title='Loot::gold' data-ref="Loot::gold" id="Loot::gold" >gold</a>);</td></tr>
<tr><th id="197">197</th><td>            <a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player25UpdateAchievementCriteriaE24AchievementCriteriaTypesjjP4Unit" title='Player::UpdateAchievementCriteria' data-ref="_ZN6Player25UpdateAchievementCriteriaE24AchievementCriteriaTypesjjP4Unit" id="_ZN6Player25UpdateAchievementCriteriaE24AchievementCriteriaTypesjjP4Unit" >UpdateAchievementCriteria</a>(<a class="enum" href="../DataStores/DBCEnums.h.html#AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_MONEY" title='AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_MONEY' data-ref="AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_MONEY" id="AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_MONEY" >ACHIEVEMENT_CRITERIA_TYPE_LOOT_MONEY</a>, <a class="local col3 ref" href="#13loot" title='loot' data-ref="13loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::gold" title='Loot::gold' data-ref="Loot::gold" id="Loot::gold" >gold</a>);</td></tr>
<tr><th id="198">198</th><td></td></tr>
<tr><th id="199">199</th><td>            <a class="type" href="../../shared/Packets/WorldPacket.h.html#WorldPacket" title='WorldPacket' data-ref="WorldPacket" >WorldPacket</a> <dfn class="local col7 decl" id="27data" title='data' data-type='WorldPacket' data-ref="27data" >data</dfn><a class="ref" href="../../shared/Packets/WorldPacket.h.html#_ZN11WorldPacketC1Etm" title='WorldPacket::WorldPacket' data-ref="_ZN11WorldPacketC1Etm" id="_ZN11WorldPacketC1Etm" >(</a><a class="enum" href="../Server/Protocol/Opcodes.h.html#Opcodes::SMSG_LOOT_MONEY_NOTIFY" title='Opcodes::SMSG_LOOT_MONEY_NOTIFY' data-ref="Opcodes::SMSG_LOOT_MONEY_NOTIFY" id="Opcodes::SMSG_LOOT_MONEY_NOTIFY" >SMSG_LOOT_MONEY_NOTIFY</a>, <var>4</var> + <var>1</var>);</td></tr>
<tr><th id="200">200</th><td>            <a class="local col7 ref" href="#27data" title='data' data-ref="27data" >data</a> <a class="ref" href="../../shared/Packets/ByteBuffer.h.html#_ZN10ByteBufferlsEj" title='ByteBuffer::operator&lt;&lt;' data-ref="_ZN10ByteBufferlsEj" id="_ZN10ByteBufferlsEj" >&lt;&lt;</a> <a class="typedef" href="../../../common/Define.h.html#uint32" title='uint32' data-type='uint32_t' data-ref="uint32" >uint32</a>(<a class="local col3 ref" href="#13loot" title='loot' data-ref="13loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::gold" title='Loot::gold' data-ref="Loot::gold" >gold</a>);</td></tr>
<tr><th id="201">201</th><td>            <a class="local col7 ref" href="#27data" title='data' data-ref="27data" >data</a> <a class="ref" href="../../shared/Packets/ByteBuffer.h.html#_ZN10ByteBufferlsEh" title='ByteBuffer::operator&lt;&lt;' data-ref="_ZN10ByteBufferlsEh" id="_ZN10ByteBufferlsEh" >&lt;&lt;</a> <a class="typedef" href="../../../common/Define.h.html#uint8" title='uint8' data-type='uint8_t' data-ref="uint8" >uint8</a>(<var>1</var>);   <i>// "You loot..."</i></td></tr>
<tr><th id="202">202</th><td>            <a class="member" href="../Server/WorldSession.h.html#_ZN12WorldSession10SendPacketEP11WorldPacket" title='WorldSession::SendPacket' data-ref="_ZN12WorldSession10SendPacketEP11WorldPacket" id="_ZN12WorldSession10SendPacketEP11WorldPacket" >SendPacket</a>(&amp;<a class="local col7 ref" href="#27data" title='data' data-ref="27data" >data</a>);</td></tr>
<tr><th id="203">203</th><td>        }</td></tr>
<tr><th id="204">204</th><td></td></tr>
<tr><th id="205">205</th><td>        <a class="local col3 ref" href="#13loot" title='loot' data-ref="13loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::gold" title='Loot::gold' data-ref="Loot::gold" id="Loot::gold" >gold</a> = <var>0</var>;</td></tr>
<tr><th id="206">206</th><td></td></tr>
<tr><th id="207">207</th><td>        <i>// Delete the money loot record from the DB</i></td></tr>
<tr><th id="208">208</th><td>        <b>if</b> (<a class="local col3 ref" href="#13loot" title='loot' data-ref="13loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::containerID" title='Loot::containerID' data-ref="Loot::containerID" id="Loot::containerID" >containerID</a> &gt; <var>0</var>)</td></tr>
<tr><th id="209">209</th><td>            <a class="local col3 ref" href="#13loot" title='loot' data-ref="13loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#_ZN4Loot34DeleteLootMoneyFromContainerItemDBEv" title='Loot::DeleteLootMoneyFromContainerItemDB' data-ref="_ZN4Loot34DeleteLootMoneyFromContainerItemDBEv" id="_ZN4Loot34DeleteLootMoneyFromContainerItemDBEv" >DeleteLootMoneyFromContainerItemDB</a>();</td></tr>
<tr><th id="210">210</th><td></td></tr>
<tr><th id="211">211</th><td>        <i>// Delete container if empty</i></td></tr>
<tr><th id="212">212</th><td>        <b>if</b> (<a class="local col3 ref" href="#13loot" title='loot' data-ref="13loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#_ZNK4Loot8isLootedEv" title='Loot::isLooted' data-ref="_ZNK4Loot8isLootedEv" id="_ZNK4Loot8isLootedEv" >isLooted</a>() &amp;&amp; <a class="local col2 ref" href="#12guid" title='guid' data-ref="12guid" >guid</a>.<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuid6IsItemEv" title='ObjectGuid::IsItem' data-ref="_ZNK10ObjectGuid6IsItemEv" id="_ZNK10ObjectGuid6IsItemEv" >IsItem</a>())</td></tr>
<tr><th id="213">213</th><td>            <a class="local col1 ref" href="#11player" title='player' data-ref="11player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZNK6Player10GetSessionEv" title='Player::GetSession' data-ref="_ZNK6Player10GetSessionEv" id="_ZNK6Player10GetSessionEv" >GetSession</a>()-&gt;<a class="member" href="#_ZN12WorldSession13DoLootReleaseE10ObjectGuid" title='WorldSession::DoLootRelease' data-ref="_ZN12WorldSession13DoLootReleaseE10ObjectGuid" >DoLootRelease</a>(<a class="local col2 ref" href="#12guid" title='guid' data-ref="12guid" >guid</a>);</td></tr>
<tr><th id="214">214</th><td>    }</td></tr>
<tr><th id="215">215</th><td>}</td></tr>
<tr><th id="216">216</th><td></td></tr>
<tr><th id="217">217</th><td><em>void</em> <a class="type" href="../Server/WorldSession.h.html#WorldSession" title='WorldSession' data-ref="WorldSession" >WorldSession</a>::<dfn class="decl def" id="_ZN12WorldSession16HandleLootOpcodeER11WorldPacket" title='WorldSession::HandleLootOpcode' data-ref="_ZN12WorldSession16HandleLootOpcodeER11WorldPacket" >HandleLootOpcode</dfn>(<a class="type" href="../../shared/Packets/WorldPacket.h.html#WorldPacket" title='WorldPacket' data-ref="WorldPacket" >WorldPacket</a>&amp; <dfn class="local col8 decl" id="28recvData" title='recvData' data-type='WorldPacket &amp;' data-ref="28recvData" >recvData</dfn>)</td></tr>
<tr><th id="218">218</th><td>{</td></tr>
<tr><th id="219">219</th><td>    <a class="macro" href="../../../common/Logging/Log.h.html#201" title="do { if (Log::instance()-&gt;ShouldLog(&quot;network&quot;, LOG_LEVEL_DEBUG)) { if (false) check_args(&quot;WORLD: CMSG_LOOT&quot;); { try { Log::instance()-&gt;outMessage(&quot;network&quot;, LOG_LEVEL_DEBUG, &quot;WORLD: CMSG_LOOT&quot;); } catch (std::exception&amp; e) { Log::instance()-&gt;outMessage(&quot;server&quot;, LOG_LEVEL_ERROR, &quot;Wrong format occurred (%s) at %s:%u.&quot;, e.what(), &quot;/home/nayd/TrinityCore/src/server/game/Handlers/LootHandler.cpp&quot;, 219); } }; } } while (0)" data-ref="_M/TC_LOG_DEBUG">TC_LOG_DEBUG</a>(<q>"network"</q>, <q>"WORLD: CMSG_LOOT"</q>);</td></tr>
<tr><th id="220">220</th><td></td></tr>
<tr><th id="221">221</th><td>    <a class="type" href="../Entities/Object/ObjectGuid.h.html#ObjectGuid" title='ObjectGuid' data-ref="ObjectGuid" >ObjectGuid</a> <dfn class="local col9 decl" id="29guid" title='guid' data-type='ObjectGuid' data-ref="29guid" >guid</dfn>;</td></tr>
<tr><th id="222">222</th><td>    <a class="local col8 ref" href="#28recvData" title='recvData' data-ref="28recvData" >recvData</a> <a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZrsR10ByteBufferR10ObjectGuid" title='operator&gt;&gt;' data-ref="_ZrsR10ByteBufferR10ObjectGuid" id="_ZrsR10ByteBufferR10ObjectGuid" >&gt;&gt;</a> <a class="local col9 ref" href="#29guid" title='guid' data-ref="29guid" >guid</a>;</td></tr>
<tr><th id="223">223</th><td></td></tr>
<tr><th id="224">224</th><td>    <i>// Check possible cheat</i></td></tr>
<tr><th id="225">225</th><td>    <b>if</b> (!<a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>()-&gt;<a class="ref" href="../Entities/Unit/Unit.h.html#_ZNK4Unit7IsAliveEv" title='Unit::IsAlive' data-ref="_ZNK4Unit7IsAliveEv" id="_ZNK4Unit7IsAliveEv" >IsAlive</a>() || !<a class="local col9 ref" href="#29guid" title='guid' data-ref="29guid" >guid</a>.<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuid19IsCreatureOrVehicleEv" title='ObjectGuid::IsCreatureOrVehicle' data-ref="_ZNK10ObjectGuid19IsCreatureOrVehicleEv" id="_ZNK10ObjectGuid19IsCreatureOrVehicleEv" >IsCreatureOrVehicle</a>())</td></tr>
<tr><th id="226">226</th><td>        <b>return</b>;</td></tr>
<tr><th id="227">227</th><td></td></tr>
<tr><th id="228">228</th><td>    <a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>()-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player8SendLootE10ObjectGuid8LootType" title='Player::SendLoot' data-ref="_ZN6Player8SendLootE10ObjectGuid8LootType" id="_ZN6Player8SendLootE10ObjectGuid8LootType" >SendLoot</a>(<a class="local col9 ref" href="#29guid" title='guid' data-ref="29guid" >guid</a>, <a class="enum" href="../Loot/LootMgr.h.html#LootType::LOOT_CORPSE" title='LootType::LOOT_CORPSE' data-ref="LootType::LOOT_CORPSE" id="LootType::LOOT_CORPSE" >LOOT_CORPSE</a>);</td></tr>
<tr><th id="229">229</th><td></td></tr>
<tr><th id="230">230</th><td>    <i>// interrupt cast</i></td></tr>
<tr><th id="231">231</th><td>    <b>if</b> (<a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>()-&gt;<a class="ref" href="../Entities/Unit/Unit.h.html#_ZNK4Unit19IsNonMeleeSpellCastEbbbbb" title='Unit::IsNonMeleeSpellCast' data-ref="_ZNK4Unit19IsNonMeleeSpellCastEbbbbb" id="_ZNK4Unit19IsNonMeleeSpellCastEbbbbb" >IsNonMeleeSpellCast</a>(<b>false</b>))</td></tr>
<tr><th id="232">232</th><td>        <a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>()-&gt;<a class="ref" href="../Entities/Unit/Unit.h.html#_ZN4Unit23InterruptNonMeleeSpellsEbjb" title='Unit::InterruptNonMeleeSpells' data-ref="_ZN4Unit23InterruptNonMeleeSpellsEbjb" id="_ZN4Unit23InterruptNonMeleeSpellsEbjb" >InterruptNonMeleeSpells</a>(<b>false</b>);</td></tr>
<tr><th id="233">233</th><td>}</td></tr>
<tr><th id="234">234</th><td></td></tr>
<tr><th id="235">235</th><td><em>void</em> <a class="type" href="../Server/WorldSession.h.html#WorldSession" title='WorldSession' data-ref="WorldSession" >WorldSession</a>::<dfn class="decl def" id="_ZN12WorldSession23HandleLootReleaseOpcodeER11WorldPacket" title='WorldSession::HandleLootReleaseOpcode' data-ref="_ZN12WorldSession23HandleLootReleaseOpcodeER11WorldPacket" >HandleLootReleaseOpcode</dfn>(<a class="type" href="../../shared/Packets/WorldPacket.h.html#WorldPacket" title='WorldPacket' data-ref="WorldPacket" >WorldPacket</a>&amp; <dfn class="local col0 decl" id="30recvData" title='recvData' data-type='WorldPacket &amp;' data-ref="30recvData" >recvData</dfn>)</td></tr>
<tr><th id="236">236</th><td>{</td></tr>
<tr><th id="237">237</th><td>    <a class="macro" href="../../../common/Logging/Log.h.html#201" title="do { if (Log::instance()-&gt;ShouldLog(&quot;network&quot;, LOG_LEVEL_DEBUG)) { if (false) check_args(&quot;WORLD: CMSG_LOOT_RELEASE&quot;); { try { Log::instance()-&gt;outMessage(&quot;network&quot;, LOG_LEVEL_DEBUG, &quot;WORLD: CMSG_LOOT_RELEASE&quot;); } catch (std::exception&amp; e) { Log::instance()-&gt;outMessage(&quot;server&quot;, LOG_LEVEL_ERROR, &quot;Wrong format occurred (%s) at %s:%u.&quot;, e.what(), &quot;/home/nayd/TrinityCore/src/server/game/Handlers/LootHandler.cpp&quot;, 237); } }; } } while (0)" data-ref="_M/TC_LOG_DEBUG">TC_LOG_DEBUG</a>(<q>"network"</q>, <q>"WORLD: CMSG_LOOT_RELEASE"</q>);</td></tr>
<tr><th id="238">238</th><td></td></tr>
<tr><th id="239">239</th><td>    <i>// cheaters can modify lguid to prevent correct apply loot release code and re-loot</i></td></tr>
<tr><th id="240">240</th><td><i>    // use internal stored guid</i></td></tr>
<tr><th id="241">241</th><td>    <a class="type" href="../Entities/Object/ObjectGuid.h.html#ObjectGuid" title='ObjectGuid' data-ref="ObjectGuid" >ObjectGuid</a> <dfn class="local col1 decl" id="31guid" title='guid' data-type='ObjectGuid' data-ref="31guid" >guid</dfn>;</td></tr>
<tr><th id="242">242</th><td>    <a class="local col0 ref" href="#30recvData" title='recvData' data-ref="30recvData" >recvData</a> <a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZrsR10ByteBufferR10ObjectGuid" title='operator&gt;&gt;' data-ref="_ZrsR10ByteBufferR10ObjectGuid" id="_ZrsR10ByteBufferR10ObjectGuid" >&gt;&gt;</a> <a class="local col1 ref" href="#31guid" title='guid' data-ref="31guid" >guid</a>;</td></tr>
<tr><th id="243">243</th><td></td></tr>
<tr><th id="244">244</th><td>    <b>if</b> (<a class="type" href="../Entities/Object/ObjectGuid.h.html#ObjectGuid" title='ObjectGuid' data-ref="ObjectGuid" >ObjectGuid</a> <dfn class="local col2 decl" id="32lguid" title='lguid' data-type='ObjectGuid' data-ref="32lguid" ><a class="local col2 ref" href="#32lguid" title='lguid' data-ref="32lguid" >lguid</a></dfn> = <a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>()-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZNK6Player11GetLootGUIDEv" title='Player::GetLootGUID' data-ref="_ZNK6Player11GetLootGUIDEv" id="_ZNK6Player11GetLootGUIDEv" >GetLootGUID</a>())</td></tr>
<tr><th id="245">245</th><td>        <b>if</b> (<a class="local col2 ref" href="#32lguid" title='lguid' data-ref="32lguid" >lguid</a> <a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuideqERKS_" title='ObjectGuid::operator==' data-ref="_ZNK10ObjectGuideqERKS_" id="_ZNK10ObjectGuideqERKS_" >==</a> <a class="local col1 ref" href="#31guid" title='guid' data-ref="31guid" >guid</a>)</td></tr>
<tr><th id="246">246</th><td>            <a class="member" href="#_ZN12WorldSession13DoLootReleaseE10ObjectGuid" title='WorldSession::DoLootRelease' data-ref="_ZN12WorldSession13DoLootReleaseE10ObjectGuid" >DoLootRelease</a>(<a class="local col2 ref" href="#32lguid" title='lguid' data-ref="32lguid" >lguid</a>);</td></tr>
<tr><th id="247">247</th><td>}</td></tr>
<tr><th id="248">248</th><td></td></tr>
<tr><th id="249">249</th><td><em>void</em> <a class="type" href="../Server/WorldSession.h.html#WorldSession" title='WorldSession' data-ref="WorldSession" >WorldSession</a>::<dfn class="decl def" id="_ZN12WorldSession13DoLootReleaseE10ObjectGuid" title='WorldSession::DoLootRelease' data-ref="_ZN12WorldSession13DoLootReleaseE10ObjectGuid" >DoLootRelease</dfn>(<a class="type" href="../Entities/Object/ObjectGuid.h.html#ObjectGuid" title='ObjectGuid' data-ref="ObjectGuid" >ObjectGuid</a> <dfn class="local col3 decl" id="33lguid" title='lguid' data-type='ObjectGuid' data-ref="33lguid" >lguid</dfn>)</td></tr>
<tr><th id="250">250</th><td>{</td></tr>
<tr><th id="251">251</th><td>    <a class="type" href="../Entities/Player/Player.h.html#Player" title='Player' data-ref="Player" >Player</a>  *<dfn class="local col4 decl" id="34player" title='player' data-type='Player *' data-ref="34player" >player</dfn> = <a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>();</td></tr>
<tr><th id="252">252</th><td>    <a class="type" href="../Loot/LootMgr.h.html#Loot" title='Loot' data-ref="Loot" >Loot</a>    *<dfn class="local col5 decl" id="35loot" title='loot' data-type='Loot *' data-ref="35loot" >loot</dfn>;</td></tr>
<tr><th id="253">253</th><td></td></tr>
<tr><th id="254">254</th><td>    <a class="local col4 ref" href="#34player" title='player' data-ref="34player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player11SetLootGUIDE10ObjectGuid" title='Player::SetLootGUID' data-ref="_ZN6Player11SetLootGUIDE10ObjectGuid" id="_ZN6Player11SetLootGUIDE10ObjectGuid" >SetLootGUID</a>(<a class="type" href="../Entities/Object/ObjectGuid.h.html#ObjectGuid" title='ObjectGuid' data-ref="ObjectGuid" >ObjectGuid</a>::<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZN10ObjectGuid5EmptyE" title='ObjectGuid::Empty' data-ref="_ZN10ObjectGuid5EmptyE" id="_ZN10ObjectGuid5EmptyE" >Empty</a>);</td></tr>
<tr><th id="255">255</th><td>    <a class="local col4 ref" href="#34player" title='player' data-ref="34player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player15SendLootReleaseE10ObjectGuid" title='Player::SendLootRelease' data-ref="_ZN6Player15SendLootReleaseE10ObjectGuid" id="_ZN6Player15SendLootReleaseE10ObjectGuid" >SendLootRelease</a>(<a class="local col3 ref" href="#33lguid" title='lguid' data-ref="33lguid" >lguid</a>);</td></tr>
<tr><th id="256">256</th><td></td></tr>
<tr><th id="257">257</th><td>    <a class="local col4 ref" href="#34player" title='player' data-ref="34player" >player</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZN6Object10RemoveFlagEtj" title='Object::RemoveFlag' data-ref="_ZN6Object10RemoveFlagEtj" id="_ZN6Object10RemoveFlagEtj" >RemoveFlag</a>(<a class="enum" href="../Entities/Object/Updates/UpdateFields.h.html#EUnitFields::UNIT_FIELD_FLAGS" title='EUnitFields::UNIT_FIELD_FLAGS' data-ref="EUnitFields::UNIT_FIELD_FLAGS" id="EUnitFields::UNIT_FIELD_FLAGS" >UNIT_FIELD_FLAGS</a>, <a class="enum" href="../Entities/Unit/Unit.h.html#UnitFlags::UNIT_FLAG_LOOTING" title='UnitFlags::UNIT_FLAG_LOOTING' data-ref="UnitFlags::UNIT_FLAG_LOOTING" id="UnitFlags::UNIT_FLAG_LOOTING" >UNIT_FLAG_LOOTING</a>);</td></tr>
<tr><th id="258">258</th><td></td></tr>
<tr><th id="259">259</th><td>    <b>if</b> (!<a class="local col4 ref" href="#34player" title='player' data-ref="34player" >player</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK6Object9IsInWorldEv" title='Object::IsInWorld' data-ref="_ZNK6Object9IsInWorldEv" id="_ZNK6Object9IsInWorldEv" >IsInWorld</a>())</td></tr>
<tr><th id="260">260</th><td>        <b>return</b>;</td></tr>
<tr><th id="261">261</th><td></td></tr>
<tr><th id="262">262</th><td>    <b>if</b> (<a class="local col3 ref" href="#33lguid" title='lguid' data-ref="33lguid" >lguid</a>.<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuid12IsGameObjectEv" title='ObjectGuid::IsGameObject' data-ref="_ZNK10ObjectGuid12IsGameObjectEv" id="_ZNK10ObjectGuid12IsGameObjectEv" >IsGameObject</a>())</td></tr>
<tr><th id="263">263</th><td>    {</td></tr>
<tr><th id="264">264</th><td>        <a class="type" href="../Entities/GameObject/GameObject.h.html#GameObject" title='GameObject' data-ref="GameObject" >GameObject</a>* <dfn class="local col6 decl" id="36go" title='go' data-type='GameObject *' data-ref="36go" >go</dfn> = <a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>()-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject6GetMapEv" title='WorldObject::GetMap' data-ref="_ZNK11WorldObject6GetMapEv" id="_ZNK11WorldObject6GetMapEv" >GetMap</a>()-&gt;<a class="ref" href="../Maps/Map.h.html#_ZN3Map13GetGameObjectERK10ObjectGuid" title='Map::GetGameObject' data-ref="_ZN3Map13GetGameObjectERK10ObjectGuid" id="_ZN3Map13GetGameObjectERK10ObjectGuid" >GetGameObject</a>(<a class="local col3 ref" href="#33lguid" title='lguid' data-ref="33lguid" >lguid</a>);</td></tr>
<tr><th id="265">265</th><td></td></tr>
<tr><th id="266">266</th><td>        <i>// not check distance for GO in case owned GO (fishing bobber case, for example) or Fishing hole GO</i></td></tr>
<tr><th id="267">267</th><td>        <b>if</b> (!<a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a> || ((<a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZNK10GameObject12GetOwnerGUIDEv" title='GameObject::GetOwnerGUID' data-ref="_ZNK10GameObject12GetOwnerGUIDEv" id="_ZNK10GameObject12GetOwnerGUIDEv" >GetOwnerGUID</a>() <a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuidneERKS_" title='ObjectGuid::operator!=' data-ref="_ZNK10ObjectGuidneERKS_" id="_ZNK10ObjectGuidneERKS_" >!=</a> <a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK6Object7GetGUIDEv" title='Object::GetGUID' data-ref="_ZNK6Object7GetGUIDEv" id="_ZNK6Object7GetGUIDEv" >GetGUID</a>() &amp;&amp; <a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZNK10GameObject9GetGoTypeEv" title='GameObject::GetGoType' data-ref="_ZNK10GameObject9GetGoTypeEv" id="_ZNK10GameObject9GetGoTypeEv" >GetGoType</a>() != <a class="enum" href="../Miscellaneous/SharedDefines.h.html#GameobjectTypes::GAMEOBJECT_TYPE_FISHINGHOLE" title='GameobjectTypes::GAMEOBJECT_TYPE_FISHINGHOLE' data-ref="GameobjectTypes::GAMEOBJECT_TYPE_FISHINGHOLE" id="GameobjectTypes::GAMEOBJECT_TYPE_FISHINGHOLE" >GAMEOBJECT_TYPE_FISHINGHOLE</a>) &amp;&amp; !<a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" title='WorldObject::IsWithinDistInMap' data-ref="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" id="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" >IsWithinDistInMap</a>(<a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>, <a class="macro" href="../Entities/Object/Object.h.html#34" title="5.0f" data-ref="_M/INTERACTION_DISTANCE">INTERACTION_DISTANCE</a>)))</td></tr>
<tr><th id="268">268</th><td>            <b>return</b>;</td></tr>
<tr><th id="269">269</th><td></td></tr>
<tr><th id="270">270</th><td>        <a class="local col5 ref" href="#35loot" title='loot' data-ref="35loot" >loot</a> = &amp;<a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#GameObject::loot" title='GameObject::loot' data-ref="GameObject::loot" id="GameObject::loot" >loot</a>;</td></tr>
<tr><th id="271">271</th><td></td></tr>
<tr><th id="272">272</th><td>        <b>if</b> (<a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZNK10GameObject9GetGoTypeEv" title='GameObject::GetGoType' data-ref="_ZNK10GameObject9GetGoTypeEv" id="_ZNK10GameObject9GetGoTypeEv" >GetGoType</a>() == <a class="enum" href="../Miscellaneous/SharedDefines.h.html#GameobjectTypes::GAMEOBJECT_TYPE_DOOR" title='GameobjectTypes::GAMEOBJECT_TYPE_DOOR' data-ref="GameobjectTypes::GAMEOBJECT_TYPE_DOOR" id="GameobjectTypes::GAMEOBJECT_TYPE_DOOR" >GAMEOBJECT_TYPE_DOOR</a>)</td></tr>
<tr><th id="273">273</th><td>        {</td></tr>
<tr><th id="274">274</th><td>            <i>// locked doors are opened with spelleffect openlock, prevent remove its as looted</i></td></tr>
<tr><th id="275">275</th><td>            <a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZN10GameObject15UseDoorOrButtonEjbP4Unit" title='GameObject::UseDoorOrButton' data-ref="_ZN10GameObject15UseDoorOrButtonEjbP4Unit" id="_ZN10GameObject15UseDoorOrButtonEjbP4Unit" >UseDoorOrButton</a>();</td></tr>
<tr><th id="276">276</th><td>        }</td></tr>
<tr><th id="277">277</th><td>        <b>else</b> <b>if</b> (<a class="local col5 ref" href="#35loot" title='loot' data-ref="35loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#_ZNK4Loot8isLootedEv" title='Loot::isLooted' data-ref="_ZNK4Loot8isLootedEv" id="_ZNK4Loot8isLootedEv" >isLooted</a>() || <a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZNK10GameObject9GetGoTypeEv" title='GameObject::GetGoType' data-ref="_ZNK10GameObject9GetGoTypeEv" id="_ZNK10GameObject9GetGoTypeEv" >GetGoType</a>() == <a class="enum" href="../Miscellaneous/SharedDefines.h.html#GameobjectTypes::GAMEOBJECT_TYPE_FISHINGNODE" title='GameobjectTypes::GAMEOBJECT_TYPE_FISHINGNODE' data-ref="GameobjectTypes::GAMEOBJECT_TYPE_FISHINGNODE" id="GameobjectTypes::GAMEOBJECT_TYPE_FISHINGNODE" >GAMEOBJECT_TYPE_FISHINGNODE</a>)</td></tr>
<tr><th id="278">278</th><td>        {</td></tr>
<tr><th id="279">279</th><td>            <b>if</b> (<a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZNK10GameObject9GetGoTypeEv" title='GameObject::GetGoType' data-ref="_ZNK10GameObject9GetGoTypeEv" id="_ZNK10GameObject9GetGoTypeEv" >GetGoType</a>() == <a class="enum" href="../Miscellaneous/SharedDefines.h.html#GameobjectTypes::GAMEOBJECT_TYPE_FISHINGHOLE" title='GameobjectTypes::GAMEOBJECT_TYPE_FISHINGHOLE' data-ref="GameobjectTypes::GAMEOBJECT_TYPE_FISHINGHOLE" id="GameobjectTypes::GAMEOBJECT_TYPE_FISHINGHOLE" >GAMEOBJECT_TYPE_FISHINGHOLE</a>)</td></tr>
<tr><th id="280">280</th><td>            {                                               <i>// The fishing hole used once more</i></td></tr>
<tr><th id="281">281</th><td>                <a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZN10GameObject6AddUseEv" title='GameObject::AddUse' data-ref="_ZN10GameObject6AddUseEv" id="_ZN10GameObject6AddUseEv" >AddUse</a>();                               <i>// if the max usage is reached, will be despawned in next tick</i></td></tr>
<tr><th id="282">282</th><td>                <b>if</b> (<a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZNK10GameObject11GetUseCountEv" title='GameObject::GetUseCount' data-ref="_ZNK10GameObject11GetUseCountEv" id="_ZNK10GameObject11GetUseCountEv" >GetUseCount</a>() &gt;= <a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZNK10GameObject10GetGOValueEv" title='GameObject::GetGOValue' data-ref="_ZNK10GameObject10GetGOValueEv" id="_ZNK10GameObject10GetGOValueEv" >GetGOValue</a>()-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#GameObjectValue::FishingHole" title='GameObjectValue::FishingHole' data-ref="GameObjectValue::FishingHole" id="GameObjectValue::FishingHole" >FishingHole</a>.<a class="ref" href="../Entities/GameObject/GameObject.h.html#GameObjectValue::(anonymous)::MaxOpens" title='GameObjectValue::(anonymous struct)::MaxOpens' data-ref="GameObjectValue::(anonymous)::MaxOpens" id="GameObjectValue::(anonymous)::MaxOpens" >MaxOpens</a>)</td></tr>
<tr><th id="283">283</th><td>                    <a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZN10GameObject12SetLootStateE9LootStateP4Unit" title='GameObject::SetLootState' data-ref="_ZN10GameObject12SetLootStateE9LootStateP4Unit" id="_ZN10GameObject12SetLootStateE9LootStateP4Unit" >SetLootState</a>(<a class="enum" href="../Entities/GameObject/GameObject.h.html#LootState::GO_JUST_DEACTIVATED" title='LootState::GO_JUST_DEACTIVATED' data-ref="LootState::GO_JUST_DEACTIVATED" id="LootState::GO_JUST_DEACTIVATED" >GO_JUST_DEACTIVATED</a>);</td></tr>
<tr><th id="284">284</th><td>                <b>else</b></td></tr>
<tr><th id="285">285</th><td>                    <a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZN10GameObject12SetLootStateE9LootStateP4Unit" title='GameObject::SetLootState' data-ref="_ZN10GameObject12SetLootStateE9LootStateP4Unit" id="_ZN10GameObject12SetLootStateE9LootStateP4Unit" >SetLootState</a>(<a class="enum" href="../Entities/GameObject/GameObject.h.html#LootState::GO_READY" title='LootState::GO_READY' data-ref="LootState::GO_READY" id="LootState::GO_READY" >GO_READY</a>);</td></tr>
<tr><th id="286">286</th><td>            }</td></tr>
<tr><th id="287">287</th><td>            <b>else</b></td></tr>
<tr><th id="288">288</th><td>                <a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZN10GameObject12SetLootStateE9LootStateP4Unit" title='GameObject::SetLootState' data-ref="_ZN10GameObject12SetLootStateE9LootStateP4Unit" id="_ZN10GameObject12SetLootStateE9LootStateP4Unit" >SetLootState</a>(<a class="enum" href="../Entities/GameObject/GameObject.h.html#LootState::GO_JUST_DEACTIVATED" title='LootState::GO_JUST_DEACTIVATED' data-ref="LootState::GO_JUST_DEACTIVATED" id="LootState::GO_JUST_DEACTIVATED" >GO_JUST_DEACTIVATED</a>);</td></tr>
<tr><th id="289">289</th><td></td></tr>
<tr><th id="290">290</th><td>            <a class="local col5 ref" href="#35loot" title='loot' data-ref="35loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#_ZN4Loot5clearEv" title='Loot::clear' data-ref="_ZN4Loot5clearEv" id="_ZN4Loot5clearEv" >clear</a>();</td></tr>
<tr><th id="291">291</th><td>        }</td></tr>
<tr><th id="292">292</th><td>        <b>else</b></td></tr>
<tr><th id="293">293</th><td>        {</td></tr>
<tr><th id="294">294</th><td>            <i>// not fully looted object</i></td></tr>
<tr><th id="295">295</th><td>            <a class="local col6 ref" href="#36go" title='go' data-ref="36go" >go</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#_ZN10GameObject12SetLootStateE9LootStateP4Unit" title='GameObject::SetLootState' data-ref="_ZN10GameObject12SetLootStateE9LootStateP4Unit" id="_ZN10GameObject12SetLootStateE9LootStateP4Unit" >SetLootState</a>(<a class="enum" href="../Entities/GameObject/GameObject.h.html#LootState::GO_ACTIVATED" title='LootState::GO_ACTIVATED' data-ref="LootState::GO_ACTIVATED" id="LootState::GO_ACTIVATED" >GO_ACTIVATED</a>, <a class="local col4 ref" href="#34player" title='player' data-ref="34player" >player</a>);</td></tr>
<tr><th id="296">296</th><td></td></tr>
<tr><th id="297">297</th><td>            <i>// if the round robin player release, reset it.</i></td></tr>
<tr><th id="298">298</th><td>            <b>if</b> (<a class="local col4 ref" href="#34player" title='player' data-ref="34player" >player</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK6Object7GetGUIDEv" title='Object::GetGUID' data-ref="_ZNK6Object7GetGUIDEv" id="_ZNK6Object7GetGUIDEv" >GetGUID</a>() <a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuideqERKS_" title='ObjectGuid::operator==' data-ref="_ZNK10ObjectGuideqERKS_" id="_ZNK10ObjectGuideqERKS_" >==</a> <a class="local col5 ref" href="#35loot" title='loot' data-ref="35loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::roundRobinPlayer" title='Loot::roundRobinPlayer' data-ref="Loot::roundRobinPlayer" >roundRobinPlayer</a>)</td></tr>
<tr><th id="299">299</th><td>                <a class="local col5 ref" href="#35loot" title='loot' data-ref="35loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::roundRobinPlayer" title='Loot::roundRobinPlayer' data-ref="Loot::roundRobinPlayer" id="Loot::roundRobinPlayer" >roundRobinPlayer</a>.<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZN10ObjectGuid5ClearEv" title='ObjectGuid::Clear' data-ref="_ZN10ObjectGuid5ClearEv" id="_ZN10ObjectGuid5ClearEv" >Clear</a>();</td></tr>
<tr><th id="300">300</th><td>        }</td></tr>
<tr><th id="301">301</th><td>    }</td></tr>
<tr><th id="302">302</th><td>    <b>else</b> <b>if</b> (<a class="local col3 ref" href="#33lguid" title='lguid' data-ref="33lguid" >lguid</a>.<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuid8IsCorpseEv" title='ObjectGuid::IsCorpse' data-ref="_ZNK10ObjectGuid8IsCorpseEv" id="_ZNK10ObjectGuid8IsCorpseEv" >IsCorpse</a>())        <i>// ONLY remove insignia at BG</i></td></tr>
<tr><th id="303">303</th><td>    {</td></tr>
<tr><th id="304">304</th><td>        <a class="type" href="../Entities/Corpse/Corpse.h.html#Corpse" title='Corpse' data-ref="Corpse" >Corpse</a>* <dfn class="local col7 decl" id="37corpse" title='corpse' data-type='Corpse *' data-ref="37corpse" >corpse</dfn> = <span class="namespace">ObjectAccessor::</span><a class="ref" href="../Globals/ObjectAccessor.h.html#_ZN14ObjectAccessor9GetCorpseERK11WorldObjectRK10ObjectGuid" title='ObjectAccessor::GetCorpse' data-ref="_ZN14ObjectAccessor9GetCorpseERK11WorldObjectRK10ObjectGuid" id="_ZN14ObjectAccessor9GetCorpseERK11WorldObjectRK10ObjectGuid" >GetCorpse</a>(*<a class="local col4 ref" href="#34player" title='player' data-ref="34player" >player</a>, <a class="local col3 ref" href="#33lguid" title='lguid' data-ref="33lguid" >lguid</a>);</td></tr>
<tr><th id="305">305</th><td>        <b>if</b> (!<a class="local col7 ref" href="#37corpse" title='corpse' data-ref="37corpse" >corpse</a> || !<a class="local col7 ref" href="#37corpse" title='corpse' data-ref="37corpse" >corpse</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" title='WorldObject::IsWithinDistInMap' data-ref="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" id="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" >IsWithinDistInMap</a>(<a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>, <a class="macro" href="../Entities/Object/Object.h.html#34" title="5.0f" data-ref="_M/INTERACTION_DISTANCE">INTERACTION_DISTANCE</a>))</td></tr>
<tr><th id="306">306</th><td>            <b>return</b>;</td></tr>
<tr><th id="307">307</th><td></td></tr>
<tr><th id="308">308</th><td>        <a class="local col5 ref" href="#35loot" title='loot' data-ref="35loot" >loot</a> = &amp;<a class="local col7 ref" href="#37corpse" title='corpse' data-ref="37corpse" >corpse</a>-&gt;<a class="ref" href="../Entities/Corpse/Corpse.h.html#Corpse::loot" title='Corpse::loot' data-ref="Corpse::loot" id="Corpse::loot" >loot</a>;</td></tr>
<tr><th id="309">309</th><td></td></tr>
<tr><th id="310">310</th><td>        <b>if</b> (<a class="local col5 ref" href="#35loot" title='loot' data-ref="35loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#_ZNK4Loot8isLootedEv" title='Loot::isLooted' data-ref="_ZNK4Loot8isLootedEv" id="_ZNK4Loot8isLootedEv" >isLooted</a>())</td></tr>
<tr><th id="311">311</th><td>        {</td></tr>
<tr><th id="312">312</th><td>            <a class="local col5 ref" href="#35loot" title='loot' data-ref="35loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#_ZN4Loot5clearEv" title='Loot::clear' data-ref="_ZN4Loot5clearEv" id="_ZN4Loot5clearEv" >clear</a>();</td></tr>
<tr><th id="313">313</th><td>            <a class="local col7 ref" href="#37corpse" title='corpse' data-ref="37corpse" >corpse</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZN6Object10RemoveFlagEtj" title='Object::RemoveFlag' data-ref="_ZN6Object10RemoveFlagEtj" id="_ZN6Object10RemoveFlagEtj" >RemoveFlag</a>(<a class="enum" href="../Entities/Object/Updates/UpdateFields.h.html#ECorpseFields::CORPSE_FIELD_DYNAMIC_FLAGS" title='ECorpseFields::CORPSE_FIELD_DYNAMIC_FLAGS' data-ref="ECorpseFields::CORPSE_FIELD_DYNAMIC_FLAGS" id="ECorpseFields::CORPSE_FIELD_DYNAMIC_FLAGS" >CORPSE_FIELD_DYNAMIC_FLAGS</a>, <a class="enum" href="../Miscellaneous/SharedDefines.h.html#CorpseDynFlags::CORPSE_DYNFLAG_LOOTABLE" title='CorpseDynFlags::CORPSE_DYNFLAG_LOOTABLE' data-ref="CorpseDynFlags::CORPSE_DYNFLAG_LOOTABLE" id="CorpseDynFlags::CORPSE_DYNFLAG_LOOTABLE" >CORPSE_DYNFLAG_LOOTABLE</a>);</td></tr>
<tr><th id="314">314</th><td>        }</td></tr>
<tr><th id="315">315</th><td>    }</td></tr>
<tr><th id="316">316</th><td>    <b>else</b> <b>if</b> (<a class="local col3 ref" href="#33lguid" title='lguid' data-ref="33lguid" >lguid</a>.<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuid6IsItemEv" title='ObjectGuid::IsItem' data-ref="_ZNK10ObjectGuid6IsItemEv" id="_ZNK10ObjectGuid6IsItemEv" >IsItem</a>())</td></tr>
<tr><th id="317">317</th><td>    {</td></tr>
<tr><th id="318">318</th><td>        <a class="type" href="../Entities/Item/Item.h.html#Item" title='Item' data-ref="Item" >Item</a>* <dfn class="local col8 decl" id="38pItem" title='pItem' data-type='Item *' data-ref="38pItem" >pItem</dfn> = <a class="local col4 ref" href="#34player" title='player' data-ref="34player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZNK6Player13GetItemByGuidE10ObjectGuid" title='Player::GetItemByGuid' data-ref="_ZNK6Player13GetItemByGuidE10ObjectGuid" id="_ZNK6Player13GetItemByGuidE10ObjectGuid" >GetItemByGuid</a>(<a class="local col3 ref" href="#33lguid" title='lguid' data-ref="33lguid" >lguid</a>);</td></tr>
<tr><th id="319">319</th><td>        <b>if</b> (!<a class="local col8 ref" href="#38pItem" title='pItem' data-ref="38pItem" >pItem</a>)</td></tr>
<tr><th id="320">320</th><td>            <b>return</b>;</td></tr>
<tr><th id="321">321</th><td></td></tr>
<tr><th id="322">322</th><td>        <a class="type" href="../Entities/Item/ItemPrototype.h.html#ItemTemplate" title='ItemTemplate' data-ref="ItemTemplate" >ItemTemplate</a> <em>const</em>* <dfn class="local col9 decl" id="39proto" title='proto' data-type='const ItemTemplate *' data-ref="39proto" >proto</dfn> = <a class="local col8 ref" href="#38pItem" title='pItem' data-ref="38pItem" >pItem</a>-&gt;<a class="ref" href="../Entities/Item/Item.h.html#_ZNK4Item11GetTemplateEv" title='Item::GetTemplate' data-ref="_ZNK4Item11GetTemplateEv" id="_ZNK4Item11GetTemplateEv" >GetTemplate</a>();</td></tr>
<tr><th id="323">323</th><td></td></tr>
<tr><th id="324">324</th><td>        <i>// destroy only 5 items from stack in case prospecting and milling</i></td></tr>
<tr><th id="325">325</th><td>        <b>if</b> (<a class="local col9 ref" href="#39proto" title='proto' data-ref="39proto" >proto</a>-&gt;<a class="ref" href="../Entities/Item/ItemPrototype.h.html#ItemTemplate::Flags" title='ItemTemplate::Flags' data-ref="ItemTemplate::Flags" id="ItemTemplate::Flags" >Flags</a> &amp; (<a class="enum" href="../Entities/Item/ItemPrototype.h.html#ItemProtoFlags::ITEM_PROTO_FLAG_PROSPECTABLE" title='ItemProtoFlags::ITEM_PROTO_FLAG_PROSPECTABLE' data-ref="ItemProtoFlags::ITEM_PROTO_FLAG_PROSPECTABLE" id="ItemProtoFlags::ITEM_PROTO_FLAG_PROSPECTABLE" >ITEM_PROTO_FLAG_PROSPECTABLE</a> | <a class="enum" href="../Entities/Item/ItemPrototype.h.html#ItemProtoFlags::ITEM_PROTO_FLAG_MILLABLE" title='ItemProtoFlags::ITEM_PROTO_FLAG_MILLABLE' data-ref="ItemProtoFlags::ITEM_PROTO_FLAG_MILLABLE" id="ItemProtoFlags::ITEM_PROTO_FLAG_MILLABLE" >ITEM_PROTO_FLAG_MILLABLE</a>))</td></tr>
<tr><th id="326">326</th><td>        {</td></tr>
<tr><th id="327">327</th><td>            <a class="local col8 ref" href="#38pItem" title='pItem' data-ref="38pItem" >pItem</a>-&gt;<a class="ref" href="../Entities/Item/Item.h.html#Item::m_lootGenerated" title='Item::m_lootGenerated' data-ref="Item::m_lootGenerated" id="Item::m_lootGenerated" >m_lootGenerated</a> = <b>false</b>;</td></tr>
<tr><th id="328">328</th><td>            <a class="local col8 ref" href="#38pItem" title='pItem' data-ref="38pItem" >pItem</a>-&gt;<a class="ref" href="../Entities/Item/Item.h.html#Item::loot" title='Item::loot' data-ref="Item::loot" id="Item::loot" >loot</a>.<a class="ref" href="../Loot/LootMgr.h.html#_ZN4Loot5clearEv" title='Loot::clear' data-ref="_ZN4Loot5clearEv" id="_ZN4Loot5clearEv" >clear</a>();</td></tr>
<tr><th id="329">329</th><td></td></tr>
<tr><th id="330">330</th><td>            <a class="typedef" href="../../../common/Define.h.html#uint32" title='uint32' data-type='uint32_t' data-ref="uint32" >uint32</a> <dfn class="local col0 decl" id="40count" title='count' data-type='uint32' data-ref="40count" >count</dfn> = <a class="local col8 ref" href="#38pItem" title='pItem' data-ref="38pItem" >pItem</a>-&gt;<a class="ref" href="../Entities/Item/Item.h.html#_ZNK4Item8GetCountEv" title='Item::GetCount' data-ref="_ZNK4Item8GetCountEv" id="_ZNK4Item8GetCountEv" >GetCount</a>();</td></tr>
<tr><th id="331">331</th><td></td></tr>
<tr><th id="332">332</th><td>            <i>// &gt;=5 checked in spell code, but will work for cheating cases also with removing from another stacks.</i></td></tr>
<tr><th id="333">333</th><td>            <b>if</b> (<a class="local col0 ref" href="#40count" title='count' data-ref="40count" >count</a> &gt; <var>5</var>)</td></tr>
<tr><th id="334">334</th><td>                <a class="local col0 ref" href="#40count" title='count' data-ref="40count" >count</a> = <var>5</var>;</td></tr>
<tr><th id="335">335</th><td></td></tr>
<tr><th id="336">336</th><td>            <a class="local col4 ref" href="#34player" title='player' data-ref="34player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player16DestroyItemCountEP4ItemRjb" title='Player::DestroyItemCount' data-ref="_ZN6Player16DestroyItemCountEP4ItemRjb" id="_ZN6Player16DestroyItemCountEP4ItemRjb" >DestroyItemCount</a>(<a class="local col8 ref" href="#38pItem" title='pItem' data-ref="38pItem" >pItem</a>, <a class="local col0 ref" href="#40count" title='count' data-ref="40count" >count</a>, <b>true</b>);</td></tr>
<tr><th id="337">337</th><td>        }</td></tr>
<tr><th id="338">338</th><td>        <b>else</b></td></tr>
<tr><th id="339">339</th><td>        {</td></tr>
<tr><th id="340">340</th><td>            <i>// Only delete item if no loot or money (unlooted loot is saved to db) or if it isn't an openable item</i></td></tr>
<tr><th id="341">341</th><td>            <b>if</b> (<a class="local col8 ref" href="#38pItem" title='pItem' data-ref="38pItem" >pItem</a>-&gt;<a class="ref" href="../Entities/Item/Item.h.html#Item::loot" title='Item::loot' data-ref="Item::loot" id="Item::loot" >loot</a>.<a class="ref" href="../Loot/LootMgr.h.html#_ZNK4Loot8isLootedEv" title='Loot::isLooted' data-ref="_ZNK4Loot8isLootedEv" id="_ZNK4Loot8isLootedEv" >isLooted</a>() || !(<a class="local col9 ref" href="#39proto" title='proto' data-ref="39proto" >proto</a>-&gt;<a class="ref" href="../Entities/Item/ItemPrototype.h.html#ItemTemplate::Flags" title='ItemTemplate::Flags' data-ref="ItemTemplate::Flags" id="ItemTemplate::Flags" >Flags</a> &amp; <a class="enum" href="../Entities/Item/ItemPrototype.h.html#ItemProtoFlags::ITEM_PROTO_FLAG_OPENABLE" title='ItemProtoFlags::ITEM_PROTO_FLAG_OPENABLE' data-ref="ItemProtoFlags::ITEM_PROTO_FLAG_OPENABLE" id="ItemProtoFlags::ITEM_PROTO_FLAG_OPENABLE" >ITEM_PROTO_FLAG_OPENABLE</a>))</td></tr>
<tr><th id="342">342</th><td>                <a class="local col4 ref" href="#34player" title='player' data-ref="34player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player11DestroyItemEhhb" title='Player::DestroyItem' data-ref="_ZN6Player11DestroyItemEhhb" id="_ZN6Player11DestroyItemEhhb" >DestroyItem</a>(<a class="local col8 ref" href="#38pItem" title='pItem' data-ref="38pItem" >pItem</a>-&gt;<a class="ref" href="../Entities/Item/Item.h.html#_ZNK4Item10GetBagSlotEv" title='Item::GetBagSlot' data-ref="_ZNK4Item10GetBagSlotEv" id="_ZNK4Item10GetBagSlotEv" >GetBagSlot</a>(), <a class="local col8 ref" href="#38pItem" title='pItem' data-ref="38pItem" >pItem</a>-&gt;<a class="ref" href="../Entities/Item/Item.h.html#_ZNK4Item7GetSlotEv" title='Item::GetSlot' data-ref="_ZNK4Item7GetSlotEv" id="_ZNK4Item7GetSlotEv" >GetSlot</a>(), <b>true</b>);</td></tr>
<tr><th id="343">343</th><td>        }</td></tr>
<tr><th id="344">344</th><td>        <b>return</b>;                                             <i>// item can be looted only single player</i></td></tr>
<tr><th id="345">345</th><td>    }</td></tr>
<tr><th id="346">346</th><td>    <b>else</b></td></tr>
<tr><th id="347">347</th><td>    {</td></tr>
<tr><th id="348">348</th><td>        <a class="type" href="../Entities/Creature/Creature.h.html#Creature" title='Creature' data-ref="Creature" >Creature</a>* <dfn class="local col1 decl" id="41creature" title='creature' data-type='Creature *' data-ref="41creature" >creature</dfn> = <a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>()-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject6GetMapEv" title='WorldObject::GetMap' data-ref="_ZNK11WorldObject6GetMapEv" id="_ZNK11WorldObject6GetMapEv" >GetMap</a>()-&gt;<a class="ref" href="../Maps/Map.h.html#_ZN3Map11GetCreatureERK10ObjectGuid" title='Map::GetCreature' data-ref="_ZN3Map11GetCreatureERK10ObjectGuid" id="_ZN3Map11GetCreatureERK10ObjectGuid" >GetCreature</a>(<a class="local col3 ref" href="#33lguid" title='lguid' data-ref="33lguid" >lguid</a>);</td></tr>
<tr><th id="349">349</th><td></td></tr>
<tr><th id="350">350</th><td>        <em>bool</em> <dfn class="local col2 decl" id="42lootAllowed" title='lootAllowed' data-type='bool' data-ref="42lootAllowed" >lootAllowed</dfn> = <a class="local col1 ref" href="#41creature" title='creature' data-ref="41creature" >creature</a> &amp;&amp; <a class="local col1 ref" href="#41creature" title='creature' data-ref="41creature" >creature</a>-&gt;<a class="ref" href="../Entities/Unit/Unit.h.html#_ZNK4Unit7IsAliveEv" title='Unit::IsAlive' data-ref="_ZNK4Unit7IsAliveEv" id="_ZNK4Unit7IsAliveEv" >IsAlive</a>() == (<a class="local col4 ref" href="#34player" title='player' data-ref="34player" >player</a>-&gt;<a class="ref" href="../Entities/Unit/Unit.h.html#_ZNK4Unit8getClassEv" title='Unit::getClass' data-ref="_ZNK4Unit8getClassEv" id="_ZNK4Unit8getClassEv" >getClass</a>() == <a class="enum" href="../Miscellaneous/SharedDefines.h.html#Classes::CLASS_ROGUE" title='Classes::CLASS_ROGUE' data-ref="Classes::CLASS_ROGUE" id="Classes::CLASS_ROGUE" >CLASS_ROGUE</a> &amp;&amp; <a class="local col1 ref" href="#41creature" title='creature' data-ref="41creature" >creature</a>-&gt;<a class="ref" href="../Entities/Creature/Creature.h.html#Creature::loot" title='Creature::loot' data-ref="Creature::loot" id="Creature::loot" >loot</a>.<a class="ref" href="../Loot/LootMgr.h.html#Loot::loot_type" title='Loot::loot_type' data-ref="Loot::loot_type" id="Loot::loot_type" >loot_type</a> == <a class="enum" href="../Loot/LootMgr.h.html#LootType::LOOT_PICKPOCKETING" title='LootType::LOOT_PICKPOCKETING' data-ref="LootType::LOOT_PICKPOCKETING" id="LootType::LOOT_PICKPOCKETING" >LOOT_PICKPOCKETING</a>);</td></tr>
<tr><th id="351">351</th><td>        <b>if</b> (!<a class="local col2 ref" href="#42lootAllowed" title='lootAllowed' data-ref="42lootAllowed" >lootAllowed</a> || !<a class="local col1 ref" href="#41creature" title='creature' data-ref="41creature" >creature</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" title='WorldObject::IsWithinDistInMap' data-ref="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" id="_ZNK11WorldObject17IsWithinDistInMapEPKS_fb" >IsWithinDistInMap</a>(<a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>, <a class="macro" href="../Entities/Object/Object.h.html#34" title="5.0f" data-ref="_M/INTERACTION_DISTANCE">INTERACTION_DISTANCE</a>))</td></tr>
<tr><th id="352">352</th><td>            <b>return</b>;</td></tr>
<tr><th id="353">353</th><td></td></tr>
<tr><th id="354">354</th><td>        <a class="local col5 ref" href="#35loot" title='loot' data-ref="35loot" >loot</a> = &amp;<a class="local col1 ref" href="#41creature" title='creature' data-ref="41creature" >creature</a>-&gt;<a class="ref" href="../Entities/Creature/Creature.h.html#Creature::loot" title='Creature::loot' data-ref="Creature::loot" id="Creature::loot" >loot</a>;</td></tr>
<tr><th id="355">355</th><td>        <b>if</b> (<a class="local col5 ref" href="#35loot" title='loot' data-ref="35loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#_ZNK4Loot8isLootedEv" title='Loot::isLooted' data-ref="_ZNK4Loot8isLootedEv" id="_ZNK4Loot8isLootedEv" >isLooted</a>())</td></tr>
<tr><th id="356">356</th><td>        {</td></tr>
<tr><th id="357">357</th><td>            <a class="local col1 ref" href="#41creature" title='creature' data-ref="41creature" >creature</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZN6Object10RemoveFlagEtj" title='Object::RemoveFlag' data-ref="_ZN6Object10RemoveFlagEtj" id="_ZN6Object10RemoveFlagEtj" >RemoveFlag</a>(<a class="enum" href="../Entities/Object/Updates/UpdateFields.h.html#EUnitFields::UNIT_DYNAMIC_FLAGS" title='EUnitFields::UNIT_DYNAMIC_FLAGS' data-ref="EUnitFields::UNIT_DYNAMIC_FLAGS" id="EUnitFields::UNIT_DYNAMIC_FLAGS" >UNIT_DYNAMIC_FLAGS</a>, <a class="enum" href="../Miscellaneous/SharedDefines.h.html#UnitDynFlags::UNIT_DYNFLAG_LOOTABLE" title='UnitDynFlags::UNIT_DYNFLAG_LOOTABLE' data-ref="UnitDynFlags::UNIT_DYNFLAG_LOOTABLE" id="UnitDynFlags::UNIT_DYNFLAG_LOOTABLE" >UNIT_DYNFLAG_LOOTABLE</a>);</td></tr>
<tr><th id="358">358</th><td></td></tr>
<tr><th id="359">359</th><td>            <i>// skip pickpocketing loot for speed, skinning timer reduction is no-op in fact</i></td></tr>
<tr><th id="360">360</th><td>            <b>if</b> (!<a class="local col1 ref" href="#41creature" title='creature' data-ref="41creature" >creature</a>-&gt;<a class="ref" href="../Entities/Unit/Unit.h.html#_ZNK4Unit7IsAliveEv" title='Unit::IsAlive' data-ref="_ZNK4Unit7IsAliveEv" id="_ZNK4Unit7IsAliveEv" >IsAlive</a>())</td></tr>
<tr><th id="361">361</th><td>                <a class="local col1 ref" href="#41creature" title='creature' data-ref="41creature" >creature</a>-&gt;<a class="ref" href="../Entities/Creature/Creature.h.html#_ZN8Creature24AllLootRemovedFromCorpseEv" title='Creature::AllLootRemovedFromCorpse' data-ref="_ZN8Creature24AllLootRemovedFromCorpseEv" id="_ZN8Creature24AllLootRemovedFromCorpseEv" >AllLootRemovedFromCorpse</a>();</td></tr>
<tr><th id="362">362</th><td></td></tr>
<tr><th id="363">363</th><td>            <a class="local col5 ref" href="#35loot" title='loot' data-ref="35loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#_ZN4Loot5clearEv" title='Loot::clear' data-ref="_ZN4Loot5clearEv" id="_ZN4Loot5clearEv" >clear</a>();</td></tr>
<tr><th id="364">364</th><td>        }</td></tr>
<tr><th id="365">365</th><td>        <b>else</b></td></tr>
<tr><th id="366">366</th><td>        {</td></tr>
<tr><th id="367">367</th><td>            <i>// if the round robin player release, reset it.</i></td></tr>
<tr><th id="368">368</th><td>            <b>if</b> (<a class="local col4 ref" href="#34player" title='player' data-ref="34player" >player</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK6Object7GetGUIDEv" title='Object::GetGUID' data-ref="_ZNK6Object7GetGUIDEv" id="_ZNK6Object7GetGUIDEv" >GetGUID</a>() <a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuideqERKS_" title='ObjectGuid::operator==' data-ref="_ZNK10ObjectGuideqERKS_" id="_ZNK10ObjectGuideqERKS_" >==</a> <a class="local col5 ref" href="#35loot" title='loot' data-ref="35loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::roundRobinPlayer" title='Loot::roundRobinPlayer' data-ref="Loot::roundRobinPlayer" >roundRobinPlayer</a>)</td></tr>
<tr><th id="369">369</th><td>            {</td></tr>
<tr><th id="370">370</th><td>                <a class="local col5 ref" href="#35loot" title='loot' data-ref="35loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::roundRobinPlayer" title='Loot::roundRobinPlayer' data-ref="Loot::roundRobinPlayer" id="Loot::roundRobinPlayer" >roundRobinPlayer</a>.<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZN10ObjectGuid5ClearEv" title='ObjectGuid::Clear' data-ref="_ZN10ObjectGuid5ClearEv" id="_ZN10ObjectGuid5ClearEv" >Clear</a>();</td></tr>
<tr><th id="371">371</th><td></td></tr>
<tr><th id="372">372</th><td>                <b>if</b> (<a class="type" href="../Groups/Group.h.html#Group" title='Group' data-ref="Group" >Group</a>* <dfn class="local col3 decl" id="43group" title='group' data-type='Group *' data-ref="43group" ><a class="local col3 ref" href="#43group" title='group' data-ref="43group" >group</a></dfn> = <a class="local col4 ref" href="#34player" title='player' data-ref="34player" >player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player8GetGroupEv" title='Player::GetGroup' data-ref="_ZN6Player8GetGroupEv" id="_ZN6Player8GetGroupEv" >GetGroup</a>())</td></tr>
<tr><th id="373">373</th><td>                {</td></tr>
<tr><th id="374">374</th><td>                    <a class="local col3 ref" href="#43group" title='group' data-ref="43group" >group</a>-&gt;<a class="ref" href="../Groups/Group.h.html#_ZN5Group10SendLooterEP8CreatureP6Player" title='Group::SendLooter' data-ref="_ZN5Group10SendLooterEP8CreatureP6Player" id="_ZN5Group10SendLooterEP8CreatureP6Player" >SendLooter</a>(<a class="local col1 ref" href="#41creature" title='creature' data-ref="41creature" >creature</a>, <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>);</td></tr>
<tr><th id="375">375</th><td></td></tr>
<tr><th id="376">376</th><td>                    <i>// force update of dynamic flags, otherwise other group's players still not able to loot.</i></td></tr>
<tr><th id="377">377</th><td>                    <a class="local col1 ref" href="#41creature" title='creature' data-ref="41creature" >creature</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZN6Object24ForceValuesUpdateAtIndexEj" title='Object::ForceValuesUpdateAtIndex' data-ref="_ZN6Object24ForceValuesUpdateAtIndexEj" id="_ZN6Object24ForceValuesUpdateAtIndexEj" >ForceValuesUpdateAtIndex</a>(<a class="enum" href="../Entities/Object/Updates/UpdateFields.h.html#EUnitFields::UNIT_DYNAMIC_FLAGS" title='EUnitFields::UNIT_DYNAMIC_FLAGS' data-ref="EUnitFields::UNIT_DYNAMIC_FLAGS" id="EUnitFields::UNIT_DYNAMIC_FLAGS" >UNIT_DYNAMIC_FLAGS</a>);</td></tr>
<tr><th id="378">378</th><td>                }</td></tr>
<tr><th id="379">379</th><td>            }</td></tr>
<tr><th id="380">380</th><td>        }</td></tr>
<tr><th id="381">381</th><td>    }</td></tr>
<tr><th id="382">382</th><td></td></tr>
<tr><th id="383">383</th><td>    <i>//Player is not looking at loot list, he doesn't need to see updates on the loot list</i></td></tr>
<tr><th id="384">384</th><td>    <a class="local col5 ref" href="#35loot" title='loot' data-ref="35loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#_ZN4Loot12RemoveLooterE10ObjectGuid" title='Loot::RemoveLooter' data-ref="_ZN4Loot12RemoveLooterE10ObjectGuid" id="_ZN4Loot12RemoveLooterE10ObjectGuid" >RemoveLooter</a>(<a class="local col4 ref" href="#34player" title='player' data-ref="34player" >player</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK6Object7GetGUIDEv" title='Object::GetGUID' data-ref="_ZNK6Object7GetGUIDEv" id="_ZNK6Object7GetGUIDEv" >GetGUID</a>());</td></tr>
<tr><th id="385">385</th><td>}</td></tr>
<tr><th id="386">386</th><td></td></tr>
<tr><th id="387">387</th><td><em>void</em> <a class="type" href="../Server/WorldSession.h.html#WorldSession" title='WorldSession' data-ref="WorldSession" >WorldSession</a>::<dfn class="decl def" id="_ZN12WorldSession26HandleLootMasterGiveOpcodeER11WorldPacket" title='WorldSession::HandleLootMasterGiveOpcode' data-ref="_ZN12WorldSession26HandleLootMasterGiveOpcodeER11WorldPacket" >HandleLootMasterGiveOpcode</dfn>(<a class="type" href="../../shared/Packets/WorldPacket.h.html#WorldPacket" title='WorldPacket' data-ref="WorldPacket" >WorldPacket</a>&amp; <dfn class="local col4 decl" id="44recvData" title='recvData' data-type='WorldPacket &amp;' data-ref="44recvData" >recvData</dfn>)</td></tr>
<tr><th id="388">388</th><td>{</td></tr>
<tr><th id="389">389</th><td>    <a class="typedef" href="../../../common/Define.h.html#uint8" title='uint8' data-type='uint8_t' data-ref="uint8" >uint8</a> <dfn class="local col5 decl" id="45slotid" title='slotid' data-type='uint8' data-ref="45slotid" >slotid</dfn>;</td></tr>
<tr><th id="390">390</th><td>    <a class="type" href="../Entities/Object/ObjectGuid.h.html#ObjectGuid" title='ObjectGuid' data-ref="ObjectGuid" ><a class="type" href="../Entities/Object/ObjectGuid.h.html#ObjectGuid" title='ObjectGuid' data-ref="ObjectGuid" >ObjectGuid</a></a> <dfn class="local col6 decl" id="46lootguid" title='lootguid' data-type='ObjectGuid' data-ref="46lootguid" >lootguid</dfn>, <dfn class="local col7 decl" id="47target_playerguid" title='target_playerguid' data-type='ObjectGuid' data-ref="47target_playerguid" >target_playerguid</dfn>;</td></tr>
<tr><th id="391">391</th><td></td></tr>
<tr><th id="392">392</th><td>    <a class="local col4 ref" href="#44recvData" title='recvData' data-ref="44recvData" >recvData</a> <a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZrsR10ByteBufferR10ObjectGuid" title='operator&gt;&gt;' data-ref="_ZrsR10ByteBufferR10ObjectGuid" id="_ZrsR10ByteBufferR10ObjectGuid" >&gt;&gt;</a> <a class="local col6 ref" href="#46lootguid" title='lootguid' data-ref="46lootguid" >lootguid</a> <a class="ref" href="../../shared/Packets/ByteBuffer.h.html#_ZN10ByteBufferrsERh" title='ByteBuffer::operator&gt;&gt;' data-ref="_ZN10ByteBufferrsERh" id="_ZN10ByteBufferrsERh" >&gt;&gt;</a> <a class="local col5 ref" href="#45slotid" title='slotid' data-ref="45slotid" >slotid</a> <a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZrsR10ByteBufferR10ObjectGuid" title='operator&gt;&gt;' data-ref="_ZrsR10ByteBufferR10ObjectGuid" id="_ZrsR10ByteBufferR10ObjectGuid" >&gt;&gt;</a> <a class="local col7 ref" href="#47target_playerguid" title='target_playerguid' data-ref="47target_playerguid" >target_playerguid</a>;</td></tr>
<tr><th id="393">393</th><td></td></tr>
<tr><th id="394">394</th><td>    <b>if</b> (!<a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player8GetGroupEv" title='Player::GetGroup' data-ref="_ZN6Player8GetGroupEv" id="_ZN6Player8GetGroupEv" >GetGroup</a>() || <a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player8GetGroupEv" title='Player::GetGroup' data-ref="_ZN6Player8GetGroupEv" id="_ZN6Player8GetGroupEv" >GetGroup</a>()-&gt;<a class="ref" href="../Groups/Group.h.html#_ZNK5Group19GetMasterLooterGuidEv" title='Group::GetMasterLooterGuid' data-ref="_ZNK5Group19GetMasterLooterGuidEv" id="_ZNK5Group19GetMasterLooterGuidEv" >GetMasterLooterGuid</a>() <a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuidneERKS_" title='ObjectGuid::operator!=' data-ref="_ZNK10ObjectGuidneERKS_" id="_ZNK10ObjectGuidneERKS_" >!=</a> <a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK6Object7GetGUIDEv" title='Object::GetGUID' data-ref="_ZNK6Object7GetGUIDEv" id="_ZNK6Object7GetGUIDEv" >GetGUID</a>() || <a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player8GetGroupEv" title='Player::GetGroup' data-ref="_ZN6Player8GetGroupEv" id="_ZN6Player8GetGroupEv" >GetGroup</a>()-&gt;<a class="ref" href="../Groups/Group.h.html#_ZNK5Group13GetLootMethodEv" title='Group::GetLootMethod' data-ref="_ZNK5Group13GetLootMethodEv" id="_ZNK5Group13GetLootMethodEv" >GetLootMethod</a>() != <a class="enum" href="../Loot/LootMgr.h.html#LootMethod::MASTER_LOOT" title='LootMethod::MASTER_LOOT' data-ref="LootMethod::MASTER_LOOT" id="LootMethod::MASTER_LOOT" >MASTER_LOOT</a>)</td></tr>
<tr><th id="395">395</th><td>    {</td></tr>
<tr><th id="396">396</th><td>        <a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player13SendLootErrorE10ObjectGuid9LootError" title='Player::SendLootError' data-ref="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" id="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" >SendLootError</a>(<a class="local col6 ref" href="#46lootguid" title='lootguid' data-ref="46lootguid" >lootguid</a>, <a class="enum" href="../Loot/LootMgr.h.html#LootError::LOOT_ERROR_DIDNT_KILL" title='LootError::LOOT_ERROR_DIDNT_KILL' data-ref="LootError::LOOT_ERROR_DIDNT_KILL" id="LootError::LOOT_ERROR_DIDNT_KILL" >LOOT_ERROR_DIDNT_KILL</a>);</td></tr>
<tr><th id="397">397</th><td>        <b>return</b>;</td></tr>
<tr><th id="398">398</th><td>    }</td></tr>
<tr><th id="399">399</th><td></td></tr>
<tr><th id="400">400</th><td>    <a class="type" href="../Entities/Player/Player.h.html#Player" title='Player' data-ref="Player" >Player</a>* <dfn class="local col8 decl" id="48target" title='target' data-type='Player *' data-ref="48target" >target</dfn> = <span class="namespace">ObjectAccessor::</span><a class="ref" href="../Globals/ObjectAccessor.h.html#_ZN14ObjectAccessor10FindPlayerERK10ObjectGuid" title='ObjectAccessor::FindPlayer' data-ref="_ZN14ObjectAccessor10FindPlayerERK10ObjectGuid" id="_ZN14ObjectAccessor10FindPlayerERK10ObjectGuid" >FindPlayer</a>(<a class="local col7 ref" href="#47target_playerguid" title='target_playerguid' data-ref="47target_playerguid" >target_playerguid</a>);</td></tr>
<tr><th id="401">401</th><td>    <b>if</b> (!<a class="local col8 ref" href="#48target" title='target' data-ref="48target" >target</a>)</td></tr>
<tr><th id="402">402</th><td>    {</td></tr>
<tr><th id="403">403</th><td>        <a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player13SendLootErrorE10ObjectGuid9LootError" title='Player::SendLootError' data-ref="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" id="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" >SendLootError</a>(<a class="local col6 ref" href="#46lootguid" title='lootguid' data-ref="46lootguid" >lootguid</a>, <a class="enum" href="../Loot/LootMgr.h.html#LootError::LOOT_ERROR_PLAYER_NOT_FOUND" title='LootError::LOOT_ERROR_PLAYER_NOT_FOUND' data-ref="LootError::LOOT_ERROR_PLAYER_NOT_FOUND" id="LootError::LOOT_ERROR_PLAYER_NOT_FOUND" >LOOT_ERROR_PLAYER_NOT_FOUND</a>);</td></tr>
<tr><th id="404">404</th><td>        <b>return</b>;</td></tr>
<tr><th id="405">405</th><td>    }</td></tr>
<tr><th id="406">406</th><td></td></tr>
<tr><th id="407">407</th><td>    <a class="macro" href="../../../common/Logging/Log.h.html#201" title="do { if (Log::instance()-&gt;ShouldLog(&quot;network&quot;, LOG_LEVEL_DEBUG)) { if (false) check_args(&quot;WorldSession::HandleLootMasterGiveOpcode (CMSG_LOOT_MASTER_GIVE, 0x02A3) Target = [%s].&quot;, target-&gt;GetName().c_str()); { try { Log::instance()-&gt;outMessage(&quot;network&quot;, LOG_LEVEL_DEBUG, &quot;WorldSession::HandleLootMasterGiveOpcode (CMSG_LOOT_MASTER_GIVE, 0x02A3) Target = [%s].&quot;, target-&gt;GetName().c_str()); } catch (std::exception&amp; e) { Log::instance()-&gt;outMessage(&quot;server&quot;, LOG_LEVEL_ERROR, &quot;Wrong format occurred (%s) at %s:%u.&quot;, e.what(), &quot;/home/nayd/TrinityCore/src/server/game/Handlers/LootHandler.cpp&quot;, 407); } }; } } while (0)" data-ref="_M/TC_LOG_DEBUG">TC_LOG_DEBUG</a>(<q>"network"</q>, <q>"WorldSession::HandleLootMasterGiveOpcode (CMSG_LOOT_MASTER_GIVE, 0x02A3) Target = [%s]."</q>, <a class="local col8 ref" href="#48target" title='target' data-ref="48target" ><a class="local col8 ref" href="#48target" title='target' data-ref="48target" >target</a></a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject7GetNameEv" title='WorldObject::GetName' data-ref="_ZNK11WorldObject7GetNameEv" id="_ZNK11WorldObject7GetNameEv" ><a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject7GetNameEv" title='WorldObject::GetName' data-ref="_ZNK11WorldObject7GetNameEv" id="_ZNK11WorldObject7GetNameEv" >GetName</a></a>().<a class="ref" href="../../../../../include/c++/4.9/bits/basic_string.h.html#_ZNKSt12basic_string5c_strEv" title='std::basic_string::c_str' data-ref="_ZNKSt12basic_string5c_strEv" id="_ZNKSt12basic_string5c_strEv" ><a class="ref" href="../../../../../include/c++/4.9/bits/basic_string.h.html#_ZNKSt12basic_string5c_strEv" title='std::basic_string::c_str' data-ref="_ZNKSt12basic_string5c_strEv" id="_ZNKSt12basic_string5c_strEv" >c_str</a></a>());</td></tr>
<tr><th id="408">408</th><td></td></tr>
<tr><th id="409">409</th><td>    <b>if</b> (<a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZNK6Player11GetLootGUIDEv" title='Player::GetLootGUID' data-ref="_ZNK6Player11GetLootGUIDEv" id="_ZNK6Player11GetLootGUIDEv" >GetLootGUID</a>() <a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuidneERKS_" title='ObjectGuid::operator!=' data-ref="_ZNK10ObjectGuidneERKS_" id="_ZNK10ObjectGuidneERKS_" >!=</a> <a class="local col6 ref" href="#46lootguid" title='lootguid' data-ref="46lootguid" >lootguid</a>)</td></tr>
<tr><th id="410">410</th><td>    {</td></tr>
<tr><th id="411">411</th><td>        <a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player13SendLootErrorE10ObjectGuid9LootError" title='Player::SendLootError' data-ref="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" id="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" >SendLootError</a>(<a class="local col6 ref" href="#46lootguid" title='lootguid' data-ref="46lootguid" >lootguid</a>, <a class="enum" href="../Loot/LootMgr.h.html#LootError::LOOT_ERROR_DIDNT_KILL" title='LootError::LOOT_ERROR_DIDNT_KILL' data-ref="LootError::LOOT_ERROR_DIDNT_KILL" id="LootError::LOOT_ERROR_DIDNT_KILL" >LOOT_ERROR_DIDNT_KILL</a>);</td></tr>
<tr><th id="412">412</th><td>        <b>return</b>;</td></tr>
<tr><th id="413">413</th><td>    }</td></tr>
<tr><th id="414">414</th><td></td></tr>
<tr><th id="415">415</th><td>    <b>if</b> (!<a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Unit/Unit.h.html#_ZNK4Unit12IsInRaidWithEPKS_" title='Unit::IsInRaidWith' data-ref="_ZNK4Unit12IsInRaidWithEPKS_" id="_ZNK4Unit12IsInRaidWithEPKS_" >IsInRaidWith</a>(<a class="local col8 ref" href="#48target" title='target' data-ref="48target" >target</a>) || !<a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject7IsInMapEPKS_" title='WorldObject::IsInMap' data-ref="_ZNK11WorldObject7IsInMapEPKS_" id="_ZNK11WorldObject7IsInMapEPKS_" >IsInMap</a>(<a class="local col8 ref" href="#48target" title='target' data-ref="48target" >target</a>))</td></tr>
<tr><th id="416">416</th><td>    {</td></tr>
<tr><th id="417">417</th><td>        <a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player13SendLootErrorE10ObjectGuid9LootError" title='Player::SendLootError' data-ref="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" id="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" >SendLootError</a>(<a class="local col6 ref" href="#46lootguid" title='lootguid' data-ref="46lootguid" >lootguid</a>, <a class="enum" href="../Loot/LootMgr.h.html#LootError::LOOT_ERROR_MASTER_OTHER" title='LootError::LOOT_ERROR_MASTER_OTHER' data-ref="LootError::LOOT_ERROR_MASTER_OTHER" id="LootError::LOOT_ERROR_MASTER_OTHER" >LOOT_ERROR_MASTER_OTHER</a>);</td></tr>
<tr><th id="418">418</th><td>        <a class="macro" href="../../../common/Logging/Log.h.html#204" title="do { if (Log::instance()-&gt;ShouldLog(&quot;loot&quot;, LOG_LEVEL_INFO)) { if (false) check_args(&quot;MasterLootItem: Player %s tried to give an item to ineligible player %s !&quot;, GetPlayer()-&gt;GetName().c_str(), target-&gt;GetName().c_str()); { try { Log::instance()-&gt;outMessage(&quot;loot&quot;, LOG_LEVEL_INFO, &quot;MasterLootItem: Player %s tried to give an item to ineligible player %s !&quot;, GetPlayer()-&gt;GetName().c_str(), target-&gt;GetName().c_str()); } catch (std::exception&amp; e) { Log::instance()-&gt;outMessage(&quot;server&quot;, LOG_LEVEL_ERROR, &quot;Wrong format occurred (%s) at %s:%u.&quot;, e.what(), &quot;/home/nayd/TrinityCore/src/server/game/Handlers/LootHandler.cpp&quot;, 418); } }; } } while (0)" data-ref="_M/TC_LOG_INFO">TC_LOG_INFO</a>(<q>"loot"</q>, <q>"MasterLootItem: Player %s tried to give an item to ineligible player %s !"</q>, <a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" ><a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a></a>()-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject7GetNameEv" title='WorldObject::GetName' data-ref="_ZNK11WorldObject7GetNameEv" id="_ZNK11WorldObject7GetNameEv" ><a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject7GetNameEv" title='WorldObject::GetName' data-ref="_ZNK11WorldObject7GetNameEv" id="_ZNK11WorldObject7GetNameEv" >GetName</a></a>().<a class="ref" href="../../../../../include/c++/4.9/bits/basic_string.h.html#_ZNKSt12basic_string5c_strEv" title='std::basic_string::c_str' data-ref="_ZNKSt12basic_string5c_strEv" id="_ZNKSt12basic_string5c_strEv" ><a class="ref" href="../../../../../include/c++/4.9/bits/basic_string.h.html#_ZNKSt12basic_string5c_strEv" title='std::basic_string::c_str' data-ref="_ZNKSt12basic_string5c_strEv" id="_ZNKSt12basic_string5c_strEv" >c_str</a></a>(), <a class="local col8 ref" href="#48target" title='target' data-ref="48target" ><a class="local col8 ref" href="#48target" title='target' data-ref="48target" >target</a></a>-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject7GetNameEv" title='WorldObject::GetName' data-ref="_ZNK11WorldObject7GetNameEv" id="_ZNK11WorldObject7GetNameEv" ><a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject7GetNameEv" title='WorldObject::GetName' data-ref="_ZNK11WorldObject7GetNameEv" id="_ZNK11WorldObject7GetNameEv" >GetName</a></a>().<a class="ref" href="../../../../../include/c++/4.9/bits/basic_string.h.html#_ZNKSt12basic_string5c_strEv" title='std::basic_string::c_str' data-ref="_ZNKSt12basic_string5c_strEv" id="_ZNKSt12basic_string5c_strEv" ><a class="ref" href="../../../../../include/c++/4.9/bits/basic_string.h.html#_ZNKSt12basic_string5c_strEv" title='std::basic_string::c_str' data-ref="_ZNKSt12basic_string5c_strEv" id="_ZNKSt12basic_string5c_strEv" >c_str</a></a>());</td></tr>
<tr><th id="419">419</th><td>        <b>return</b>;</td></tr>
<tr><th id="420">420</th><td>    }</td></tr>
<tr><th id="421">421</th><td></td></tr>
<tr><th id="422">422</th><td>    <a class="type" href="../Loot/LootMgr.h.html#Loot" title='Loot' data-ref="Loot" >Loot</a>* <dfn class="local col9 decl" id="49loot" title='loot' data-type='Loot *' data-ref="49loot" >loot</dfn> = <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>;</td></tr>
<tr><th id="423">423</th><td></td></tr>
<tr><th id="424">424</th><td>    <b>if</b> (<a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>()-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZNK6Player11GetLootGUIDEv" title='Player::GetLootGUID' data-ref="_ZNK6Player11GetLootGUIDEv" id="_ZNK6Player11GetLootGUIDEv" >GetLootGUID</a>().<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuid19IsCreatureOrVehicleEv" title='ObjectGuid::IsCreatureOrVehicle' data-ref="_ZNK10ObjectGuid19IsCreatureOrVehicleEv" id="_ZNK10ObjectGuid19IsCreatureOrVehicleEv" >IsCreatureOrVehicle</a>())</td></tr>
<tr><th id="425">425</th><td>    {</td></tr>
<tr><th id="426">426</th><td>        <a class="type" href="../Entities/Creature/Creature.h.html#Creature" title='Creature' data-ref="Creature" >Creature</a>* <dfn class="local col0 decl" id="50creature" title='creature' data-type='Creature *' data-ref="50creature" >creature</dfn> = <a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>()-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject6GetMapEv" title='WorldObject::GetMap' data-ref="_ZNK11WorldObject6GetMapEv" id="_ZNK11WorldObject6GetMapEv" >GetMap</a>()-&gt;<a class="ref" href="../Maps/Map.h.html#_ZN3Map11GetCreatureERK10ObjectGuid" title='Map::GetCreature' data-ref="_ZN3Map11GetCreatureERK10ObjectGuid" id="_ZN3Map11GetCreatureERK10ObjectGuid" >GetCreature</a>(<a class="local col6 ref" href="#46lootguid" title='lootguid' data-ref="46lootguid" >lootguid</a>);</td></tr>
<tr><th id="427">427</th><td>        <b>if</b> (!<a class="local col0 ref" href="#50creature" title='creature' data-ref="50creature" >creature</a>)</td></tr>
<tr><th id="428">428</th><td>            <b>return</b>;</td></tr>
<tr><th id="429">429</th><td></td></tr>
<tr><th id="430">430</th><td>        <a class="local col9 ref" href="#49loot" title='loot' data-ref="49loot" >loot</a> = &amp;<a class="local col0 ref" href="#50creature" title='creature' data-ref="50creature" >creature</a>-&gt;<a class="ref" href="../Entities/Creature/Creature.h.html#Creature::loot" title='Creature::loot' data-ref="Creature::loot" id="Creature::loot" >loot</a>;</td></tr>
<tr><th id="431">431</th><td>    }</td></tr>
<tr><th id="432">432</th><td>    <b>else</b> <b>if</b> (<a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>()-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZNK6Player11GetLootGUIDEv" title='Player::GetLootGUID' data-ref="_ZNK6Player11GetLootGUIDEv" id="_ZNK6Player11GetLootGUIDEv" >GetLootGUID</a>().<a class="ref" href="../Entities/Object/ObjectGuid.h.html#_ZNK10ObjectGuid12IsGameObjectEv" title='ObjectGuid::IsGameObject' data-ref="_ZNK10ObjectGuid12IsGameObjectEv" id="_ZNK10ObjectGuid12IsGameObjectEv" >IsGameObject</a>())</td></tr>
<tr><th id="433">433</th><td>    {</td></tr>
<tr><th id="434">434</th><td>        <a class="type" href="../Entities/GameObject/GameObject.h.html#GameObject" title='GameObject' data-ref="GameObject" >GameObject</a>* <dfn class="local col1 decl" id="51pGO" title='pGO' data-type='GameObject *' data-ref="51pGO" >pGO</dfn> = <a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a>()-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject6GetMapEv" title='WorldObject::GetMap' data-ref="_ZNK11WorldObject6GetMapEv" id="_ZNK11WorldObject6GetMapEv" >GetMap</a>()-&gt;<a class="ref" href="../Maps/Map.h.html#_ZN3Map13GetGameObjectERK10ObjectGuid" title='Map::GetGameObject' data-ref="_ZN3Map13GetGameObjectERK10ObjectGuid" id="_ZN3Map13GetGameObjectERK10ObjectGuid" >GetGameObject</a>(<a class="local col6 ref" href="#46lootguid" title='lootguid' data-ref="46lootguid" >lootguid</a>);</td></tr>
<tr><th id="435">435</th><td>        <b>if</b> (!<a class="local col1 ref" href="#51pGO" title='pGO' data-ref="51pGO" >pGO</a>)</td></tr>
<tr><th id="436">436</th><td>            <b>return</b>;</td></tr>
<tr><th id="437">437</th><td></td></tr>
<tr><th id="438">438</th><td>        <a class="local col9 ref" href="#49loot" title='loot' data-ref="49loot" >loot</a> = &amp;<a class="local col1 ref" href="#51pGO" title='pGO' data-ref="51pGO" >pGO</a>-&gt;<a class="ref" href="../Entities/GameObject/GameObject.h.html#GameObject::loot" title='GameObject::loot' data-ref="GameObject::loot" id="GameObject::loot" >loot</a>;</td></tr>
<tr><th id="439">439</th><td>    }</td></tr>
<tr><th id="440">440</th><td></td></tr>
<tr><th id="441">441</th><td>    <b>if</b> (!<a class="local col9 ref" href="#49loot" title='loot' data-ref="49loot" >loot</a>)</td></tr>
<tr><th id="442">442</th><td>        <b>return</b>;</td></tr>
<tr><th id="443">443</th><td></td></tr>
<tr><th id="444">444</th><td>    <b>if</b> (<a class="local col5 ref" href="#45slotid" title='slotid' data-ref="45slotid" >slotid</a> &gt;= <a class="local col9 ref" href="#49loot" title='loot' data-ref="49loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::items" title='Loot::items' data-ref="Loot::items" id="Loot::items" >items</a>.<a class="ref" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv" id="_ZNKSt6vector4sizeEv" >size</a>() + <a class="local col9 ref" href="#49loot" title='loot' data-ref="49loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::quest_items" title='Loot::quest_items' data-ref="Loot::quest_items" id="Loot::quest_items" >quest_items</a>.<a class="ref" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv" id="_ZNKSt6vector4sizeEv" >size</a>())</td></tr>
<tr><th id="445">445</th><td>    {</td></tr>
<tr><th id="446">446</th><td>        <a class="macro" href="../../../common/Logging/Log.h.html#201" title="do { if (Log::instance()-&gt;ShouldLog(&quot;loot&quot;, LOG_LEVEL_DEBUG)) { if (false) check_args(&quot;MasterLootItem: Player %s might be using a hack! (slot %d, size %lu)&quot;, GetPlayer()-&gt;GetName().c_str(), slotid, (unsigned long)loot-&gt;items.size()); { try { Log::instance()-&gt;outMessage(&quot;loot&quot;, LOG_LEVEL_DEBUG, &quot;MasterLootItem: Player %s might be using a hack! (slot %d, size %lu)&quot;, GetPlayer()-&gt;GetName().c_str(), slotid, (unsigned long)loot-&gt;items.size()); } catch (std::exception&amp; e) { Log::instance()-&gt;outMessage(&quot;server&quot;, LOG_LEVEL_ERROR, &quot;Wrong format occurred (%s) at %s:%u.&quot;, e.what(), &quot;/home/nayd/TrinityCore/src/server/game/Handlers/LootHandler.cpp&quot;, 447); } }; } } while (0)" data-ref="_M/TC_LOG_DEBUG">TC_LOG_DEBUG</a>(<q>"loot"</q>, <q>"MasterLootItem: Player %s might be using a hack! (slot %d, size %lu)"</q>,</td></tr>
<tr><th id="447">447</th><td>            <a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" ><a class="member" href="../Server/WorldSession.h.html#_ZNK12WorldSession9GetPlayerEv" title='WorldSession::GetPlayer' data-ref="_ZNK12WorldSession9GetPlayerEv" id="_ZNK12WorldSession9GetPlayerEv" >GetPlayer</a></a>()-&gt;<a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject7GetNameEv" title='WorldObject::GetName' data-ref="_ZNK11WorldObject7GetNameEv" id="_ZNK11WorldObject7GetNameEv" ><a class="ref" href="../Entities/Object/Object.h.html#_ZNK11WorldObject7GetNameEv" title='WorldObject::GetName' data-ref="_ZNK11WorldObject7GetNameEv" id="_ZNK11WorldObject7GetNameEv" >GetName</a></a>().<a class="ref" href="../../../../../include/c++/4.9/bits/basic_string.h.html#_ZNKSt12basic_string5c_strEv" title='std::basic_string::c_str' data-ref="_ZNKSt12basic_string5c_strEv" id="_ZNKSt12basic_string5c_strEv" ><a class="ref" href="../../../../../include/c++/4.9/bits/basic_string.h.html#_ZNKSt12basic_string5c_strEv" title='std::basic_string::c_str' data-ref="_ZNKSt12basic_string5c_strEv" id="_ZNKSt12basic_string5c_strEv" >c_str</a></a>(), <a class="local col5 ref" href="#45slotid" title='slotid' data-ref="45slotid" ><a class="local col5 ref" href="#45slotid" title='slotid' data-ref="45slotid" >slotid</a></a>, (<em>unsigned</em> <em>long</em>)<a class="local col9 ref" href="#49loot" title='loot' data-ref="49loot" ><a class="local col9 ref" href="#49loot" title='loot' data-ref="49loot" >loot</a></a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::items" title='Loot::items' data-ref="Loot::items" id="Loot::items" ><a class="ref" href="../Loot/LootMgr.h.html#Loot::items" title='Loot::items' data-ref="Loot::items" id="Loot::items" >items</a></a>.<a class="ref" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv" id="_ZNKSt6vector4sizeEv" ><a class="ref" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv" id="_ZNKSt6vector4sizeEv" >size</a></a>());</td></tr>
<tr><th id="448">448</th><td>        <b>return</b>;</td></tr>
<tr><th id="449">449</th><td>    }</td></tr>
<tr><th id="450">450</th><td></td></tr>
<tr><th id="451">451</th><td>    <a class="type" href="../Loot/LootMgr.h.html#LootItem" title='LootItem' data-ref="LootItem" >LootItem</a>&amp; <dfn class="local col2 decl" id="52item" title='item' data-type='LootItem &amp;' data-ref="52item" >item</dfn> = <a class="local col5 ref" href="#45slotid" title='slotid' data-ref="45slotid" >slotid</a> &gt;= <a class="local col9 ref" href="#49loot" title='loot' data-ref="49loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::items" title='Loot::items' data-ref="Loot::items" id="Loot::items" >items</a>.<a class="ref" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv" id="_ZNKSt6vector4sizeEv" >size</a>() ? <a class="local col9 ref" href="#49loot" title='loot' data-ref="49loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::quest_items" title='Loot::quest_items' data-ref="Loot::quest_items" id="Loot::quest_items" >quest_items</a><a class="ref" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm" id="_ZNSt6vectorixEm" >[<a class="local col5 ref" href="#45slotid" title='slotid' data-ref="45slotid" >slotid</a> - <a class="local col9 ref" href="#49loot" title='loot' data-ref="49loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::items" title='Loot::items' data-ref="Loot::items" id="Loot::items" >items</a>.<a class="ref" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv" id="_ZNKSt6vector4sizeEv" >size</a>()]</a> : <a class="local col9 ref" href="#49loot" title='loot' data-ref="49loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::items" title='Loot::items' data-ref="Loot::items" id="Loot::items" >items</a><a class="ref" href="../../../../../include/c++/4.9/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm" id="_ZNSt6vectorixEm" >[<a class="local col5 ref" href="#45slotid" title='slotid' data-ref="45slotid" >slotid</a>]</a>;</td></tr>
<tr><th id="452">452</th><td></td></tr>
<tr><th id="453">453</th><td>    <a class="typedef" href="../Entities/Player/Player.h.html#ItemPosCountVec" title='ItemPosCountVec' data-type='std::vector&lt;ItemPosCount&gt;' data-ref="ItemPosCountVec" >ItemPosCountVec</a> <dfn class="local col3 decl" id="53dest" title='dest' data-type='ItemPosCountVec' data-ref="53dest" >dest</dfn>;</td></tr>
<tr><th id="454">454</th><td>    <a class="type" href="../Entities/Item/Item.h.html#InventoryResult" title='InventoryResult' data-ref="InventoryResult" >InventoryResult</a> <dfn class="local col4 decl" id="54msg" title='msg' data-type='InventoryResult' data-ref="54msg" >msg</dfn> = <a class="local col8 ref" href="#48target" title='target' data-ref="48target" >target</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZNK6Player15CanStoreNewItemEhhRSt6vectorI12ItemPosCountSaIS1_EEjjPj" title='Player::CanStoreNewItem' data-ref="_ZNK6Player15CanStoreNewItemEhhRSt6vectorI12ItemPosCountSaIS1_EEjjPj" id="_ZNK6Player15CanStoreNewItemEhhRSt6vectorI12ItemPosCountSaIS1_EEjjPj" >CanStoreNewItem</a>(<a class="enum" href="../Entities/Unit/Unit.h.html#InventorySlot::NULL_BAG" title='InventorySlot::NULL_BAG' data-ref="InventorySlot::NULL_BAG" id="InventorySlot::NULL_BAG" >NULL_BAG</a>, <a class="enum" href="../Entities/Unit/Unit.h.html#InventorySlot::NULL_SLOT" title='InventorySlot::NULL_SLOT' data-ref="InventorySlot::NULL_SLOT" id="InventorySlot::NULL_SLOT" >NULL_SLOT</a>, <a class="local col3 ref" href="#53dest" title='dest' data-ref="53dest" >dest</a>, <a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#LootItem::itemid" title='LootItem::itemid' data-ref="LootItem::itemid" id="LootItem::itemid" >itemid</a>, <a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#LootItem::count" title='LootItem::count' data-ref="LootItem::count" id="LootItem::count" >count</a>);</td></tr>
<tr><th id="455">455</th><td>    <b>if</b> (<a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#LootItem::follow_loot_rules" title='LootItem::follow_loot_rules' data-ref="LootItem::follow_loot_rules" id="LootItem::follow_loot_rules" >follow_loot_rules</a> &amp;&amp; !<a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#_ZNK8LootItem16AllowedForPlayerEPK6Player" title='LootItem::AllowedForPlayer' data-ref="_ZNK8LootItem16AllowedForPlayerEPK6Player" id="_ZNK8LootItem16AllowedForPlayerEPK6Player" >AllowedForPlayer</a>(<a class="local col8 ref" href="#48target" title='target' data-ref="48target" >target</a>))</td></tr>
<tr><th id="456">456</th><td>        <a class="local col4 ref" href="#54msg" title='msg' data-ref="54msg" >msg</a> = <a class="enum" href="../Entities/Item/Item.h.html#InventoryResult::EQUIP_ERR_YOU_CAN_NEVER_USE_THAT_ITEM" title='InventoryResult::EQUIP_ERR_YOU_CAN_NEVER_USE_THAT_ITEM' data-ref="InventoryResult::EQUIP_ERR_YOU_CAN_NEVER_USE_THAT_ITEM" id="InventoryResult::EQUIP_ERR_YOU_CAN_NEVER_USE_THAT_ITEM" >EQUIP_ERR_YOU_CAN_NEVER_USE_THAT_ITEM</a>;</td></tr>
<tr><th id="457">457</th><td>    <b>if</b> (<a class="local col4 ref" href="#54msg" title='msg' data-ref="54msg" >msg</a> != <a class="enum" href="../Entities/Item/Item.h.html#InventoryResult::EQUIP_ERR_OK" title='InventoryResult::EQUIP_ERR_OK' data-ref="InventoryResult::EQUIP_ERR_OK" id="InventoryResult::EQUIP_ERR_OK" >EQUIP_ERR_OK</a>)</td></tr>
<tr><th id="458">458</th><td>    {</td></tr>
<tr><th id="459">459</th><td>        <b>if</b> (<a class="local col4 ref" href="#54msg" title='msg' data-ref="54msg" >msg</a> == <a class="enum" href="../Entities/Item/Item.h.html#InventoryResult::EQUIP_ERR_CANT_CARRY_MORE_OF_THIS" title='InventoryResult::EQUIP_ERR_CANT_CARRY_MORE_OF_THIS' data-ref="InventoryResult::EQUIP_ERR_CANT_CARRY_MORE_OF_THIS" id="InventoryResult::EQUIP_ERR_CANT_CARRY_MORE_OF_THIS" >EQUIP_ERR_CANT_CARRY_MORE_OF_THIS</a>)</td></tr>
<tr><th id="460">460</th><td>            <a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player13SendLootErrorE10ObjectGuid9LootError" title='Player::SendLootError' data-ref="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" id="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" >SendLootError</a>(<a class="local col6 ref" href="#46lootguid" title='lootguid' data-ref="46lootguid" >lootguid</a>, <a class="enum" href="../Loot/LootMgr.h.html#LootError::LOOT_ERROR_MASTER_UNIQUE_ITEM" title='LootError::LOOT_ERROR_MASTER_UNIQUE_ITEM' data-ref="LootError::LOOT_ERROR_MASTER_UNIQUE_ITEM" id="LootError::LOOT_ERROR_MASTER_UNIQUE_ITEM" >LOOT_ERROR_MASTER_UNIQUE_ITEM</a>);</td></tr>
<tr><th id="461">461</th><td>        <b>else</b> <b>if</b> (<a class="local col4 ref" href="#54msg" title='msg' data-ref="54msg" >msg</a> == <a class="enum" href="../Entities/Item/Item.h.html#InventoryResult::EQUIP_ERR_INVENTORY_FULL" title='InventoryResult::EQUIP_ERR_INVENTORY_FULL' data-ref="InventoryResult::EQUIP_ERR_INVENTORY_FULL" id="InventoryResult::EQUIP_ERR_INVENTORY_FULL" >EQUIP_ERR_INVENTORY_FULL</a>)</td></tr>
<tr><th id="462">462</th><td>            <a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player13SendLootErrorE10ObjectGuid9LootError" title='Player::SendLootError' data-ref="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" id="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" >SendLootError</a>(<a class="local col6 ref" href="#46lootguid" title='lootguid' data-ref="46lootguid" >lootguid</a>, <a class="enum" href="../Loot/LootMgr.h.html#LootError::LOOT_ERROR_MASTER_INV_FULL" title='LootError::LOOT_ERROR_MASTER_INV_FULL' data-ref="LootError::LOOT_ERROR_MASTER_INV_FULL" id="LootError::LOOT_ERROR_MASTER_INV_FULL" >LOOT_ERROR_MASTER_INV_FULL</a>);</td></tr>
<tr><th id="463">463</th><td>        <b>else</b></td></tr>
<tr><th id="464">464</th><td>            <a class="member" href="../Server/WorldSession.h.html#WorldSession::_player" title='WorldSession::_player' data-ref="WorldSession::_player" id="WorldSession::_player" >_player</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player13SendLootErrorE10ObjectGuid9LootError" title='Player::SendLootError' data-ref="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" id="_ZN6Player13SendLootErrorE10ObjectGuid9LootError" >SendLootError</a>(<a class="local col6 ref" href="#46lootguid" title='lootguid' data-ref="46lootguid" >lootguid</a>, <a class="enum" href="../Loot/LootMgr.h.html#LootError::LOOT_ERROR_MASTER_OTHER" title='LootError::LOOT_ERROR_MASTER_OTHER' data-ref="LootError::LOOT_ERROR_MASTER_OTHER" id="LootError::LOOT_ERROR_MASTER_OTHER" >LOOT_ERROR_MASTER_OTHER</a>);</td></tr>
<tr><th id="465">465</th><td></td></tr>
<tr><th id="466">466</th><td>        <a class="local col8 ref" href="#48target" title='target' data-ref="48target" >target</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player14SendEquipErrorE15InventoryResultP4ItemS2_j" title='Player::SendEquipError' data-ref="_ZN6Player14SendEquipErrorE15InventoryResultP4ItemS2_j" id="_ZN6Player14SendEquipErrorE15InventoryResultP4ItemS2_j" >SendEquipError</a>(<a class="local col4 ref" href="#54msg" title='msg' data-ref="54msg" >msg</a>, <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>, <span class="macro" title="__null" data-ref="_M/NULL">NULL</span>, <a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#LootItem::itemid" title='LootItem::itemid' data-ref="LootItem::itemid" id="LootItem::itemid" >itemid</a>);</td></tr>
<tr><th id="467">467</th><td>        <b>return</b>;</td></tr>
<tr><th id="468">468</th><td>    }</td></tr>
<tr><th id="469">469</th><td></td></tr>
<tr><th id="470">470</th><td>    <i>// list of players allowed to receive this item in trade</i></td></tr>
<tr><th id="471">471</th><td>    <a class="typedef" href="../Loot/LootMgr.h.html#AllowedLooterSet" title='AllowedLooterSet' data-type='std::set&lt;ObjectGuid::LowType&gt;' data-ref="AllowedLooterSet" >AllowedLooterSet</a> <dfn class="local col5 decl" id="55looters" title='looters' data-type='AllowedLooterSet' data-ref="55looters" >looters</dfn> = <a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#_ZNK8LootItem17GetAllowedLootersEv" title='LootItem::GetAllowedLooters' data-ref="_ZNK8LootItem17GetAllowedLootersEv" id="_ZNK8LootItem17GetAllowedLootersEv" >GetAllowedLooters</a>();</td></tr>
<tr><th id="472">472</th><td></td></tr>
<tr><th id="473">473</th><td>    <i>// now move item from loot to target inventory</i></td></tr>
<tr><th id="474">474</th><td>    <a class="type" href="../Entities/Item/Item.h.html#Item" title='Item' data-ref="Item" >Item</a>* <dfn class="local col6 decl" id="56newitem" title='newitem' data-type='Item *' data-ref="56newitem" >newitem</dfn> = <a class="local col8 ref" href="#48target" title='target' data-ref="48target" >target</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player12StoreNewItemERKSt6vectorI12ItemPosCountSaIS1_EEjbiRKSt3setIjSt4lessIjESaIjEE" title='Player::StoreNewItem' data-ref="_ZN6Player12StoreNewItemERKSt6vectorI12ItemPosCountSaIS1_EEjbiRKSt3setIjSt4lessIjESaIjEE" id="_ZN6Player12StoreNewItemERKSt6vectorI12ItemPosCountSaIS1_EEjbiRKSt3setIjSt4lessIjESaIjEE" >StoreNewItem</a>(<a class="local col3 ref" href="#53dest" title='dest' data-ref="53dest" >dest</a>, <a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#LootItem::itemid" title='LootItem::itemid' data-ref="LootItem::itemid" id="LootItem::itemid" >itemid</a>, <b>true</b>, <a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#LootItem::randomPropertyId" title='LootItem::randomPropertyId' data-ref="LootItem::randomPropertyId" id="LootItem::randomPropertyId" >randomPropertyId</a>, <a class="local col5 ref" href="#55looters" title='looters' data-ref="55looters" >looters</a>);</td></tr>
<tr><th id="475">475</th><td>    <a class="local col8 ref" href="#48target" title='target' data-ref="48target" >target</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player11SendNewItemEP4Itemjbbb" title='Player::SendNewItem' data-ref="_ZN6Player11SendNewItemEP4Itemjbbb" id="_ZN6Player11SendNewItemEP4Itemjbbb" >SendNewItem</a>(<a class="local col6 ref" href="#56newitem" title='newitem' data-ref="56newitem" >newitem</a>, <a class="typedef" href="../../../common/Define.h.html#uint32" title='uint32' data-type='uint32_t' data-ref="uint32" >uint32</a>(<a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#LootItem::count" title='LootItem::count' data-ref="LootItem::count" id="LootItem::count" >count</a>), <b>false</b>, <b>false</b>, <b>true</b>);</td></tr>
<tr><th id="476">476</th><td>    <a class="local col8 ref" href="#48target" title='target' data-ref="48target" >target</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player25UpdateAchievementCriteriaE24AchievementCriteriaTypesjjP4Unit" title='Player::UpdateAchievementCriteria' data-ref="_ZN6Player25UpdateAchievementCriteriaE24AchievementCriteriaTypesjjP4Unit" id="_ZN6Player25UpdateAchievementCriteriaE24AchievementCriteriaTypesjjP4Unit" >UpdateAchievementCriteria</a>(<a class="enum" href="../DataStores/DBCEnums.h.html#AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_ITEM" title='AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_ITEM' data-ref="AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_ITEM" id="AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_ITEM" >ACHIEVEMENT_CRITERIA_TYPE_LOOT_ITEM</a>, <a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#LootItem::itemid" title='LootItem::itemid' data-ref="LootItem::itemid" id="LootItem::itemid" >itemid</a>, <a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#LootItem::count" title='LootItem::count' data-ref="LootItem::count" id="LootItem::count" >count</a>);</td></tr>
<tr><th id="477">477</th><td>    <a class="local col8 ref" href="#48target" title='target' data-ref="48target" >target</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player25UpdateAchievementCriteriaE24AchievementCriteriaTypesjjP4Unit" title='Player::UpdateAchievementCriteria' data-ref="_ZN6Player25UpdateAchievementCriteriaE24AchievementCriteriaTypesjjP4Unit" id="_ZN6Player25UpdateAchievementCriteriaE24AchievementCriteriaTypesjjP4Unit" >UpdateAchievementCriteria</a>(<a class="enum" href="../DataStores/DBCEnums.h.html#AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_TYPE" title='AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_TYPE' data-ref="AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_TYPE" id="AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_TYPE" >ACHIEVEMENT_CRITERIA_TYPE_LOOT_TYPE</a>, <a class="local col9 ref" href="#49loot" title='loot' data-ref="49loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::loot_type" title='Loot::loot_type' data-ref="Loot::loot_type" id="Loot::loot_type" >loot_type</a>, <a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#LootItem::count" title='LootItem::count' data-ref="LootItem::count" id="LootItem::count" >count</a>);</td></tr>
<tr><th id="478">478</th><td>    <a class="local col8 ref" href="#48target" title='target' data-ref="48target" >target</a>-&gt;<a class="ref" href="../Entities/Player/Player.h.html#_ZN6Player25UpdateAchievementCriteriaE24AchievementCriteriaTypesjjP4Unit" title='Player::UpdateAchievementCriteria' data-ref="_ZN6Player25UpdateAchievementCriteriaE24AchievementCriteriaTypesjjP4Unit" id="_ZN6Player25UpdateAchievementCriteriaE24AchievementCriteriaTypesjjP4Unit" >UpdateAchievementCriteria</a>(<a class="enum" href="../DataStores/DBCEnums.h.html#AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_EPIC_ITEM" title='AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_EPIC_ITEM' data-ref="AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_EPIC_ITEM" id="AchievementCriteriaTypes::ACHIEVEMENT_CRITERIA_TYPE_LOOT_EPIC_ITEM" >ACHIEVEMENT_CRITERIA_TYPE_LOOT_EPIC_ITEM</a>, <a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#LootItem::itemid" title='LootItem::itemid' data-ref="LootItem::itemid" id="LootItem::itemid" >itemid</a>, <a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#LootItem::count" title='LootItem::count' data-ref="LootItem::count" id="LootItem::count" >count</a>);</td></tr>
<tr><th id="479">479</th><td></td></tr>
<tr><th id="480">480</th><td>    <i>// mark as looted</i></td></tr>
<tr><th id="481">481</th><td>    <a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#LootItem::count" title='LootItem::count' data-ref="LootItem::count" id="LootItem::count" >count</a> = <var>0</var>;</td></tr>
<tr><th id="482">482</th><td>    <a class="local col2 ref" href="#52item" title='item' data-ref="52item" >item</a>.<a class="ref" href="../Loot/LootMgr.h.html#LootItem::is_looted" title='LootItem::is_looted' data-ref="LootItem::is_looted" id="LootItem::is_looted" >is_looted</a> = <b>true</b>;</td></tr>
<tr><th id="483">483</th><td></td></tr>
<tr><th id="484">484</th><td>    <a class="local col9 ref" href="#49loot" title='loot' data-ref="49loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#_ZN4Loot17NotifyItemRemovedEh" title='Loot::NotifyItemRemoved' data-ref="_ZN4Loot17NotifyItemRemovedEh" id="_ZN4Loot17NotifyItemRemovedEh" >NotifyItemRemoved</a>(<a class="local col5 ref" href="#45slotid" title='slotid' data-ref="45slotid" >slotid</a>);</td></tr>
<tr><th id="485">485</th><td>    --<a class="local col9 ref" href="#49loot" title='loot' data-ref="49loot" >loot</a>-&gt;<a class="ref" href="../Loot/LootMgr.h.html#Loot::unlootedCount" title='Loot::unlootedCount' data-ref="Loot::unlootedCount" id="Loot::unlootedCount" >unlootedCount</a>;</td></tr>
<tr><th id="486">486</th><td>}</td></tr>
<tr><th id="487">487</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2016-Mar-09</em> from project TrinityCore3.3.5 revision <em>3.3.5</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 1.8
</p>
</div></body></html>
